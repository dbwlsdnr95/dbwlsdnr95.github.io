<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/profile_cute.png"/><link rel="stylesheet" href="/_next/static/css/fff7d7d50ba66cff.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-c50cb70e7323352b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-f8546037c2082669.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-baff347ce7e39457.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-069982e43c2ae463.js" async=""></script><script src="/_next/static/chunks/app/layout-10c7e025b6149e17.js" async=""></script><script src="/_next/static/chunks/app/page-e31ae51de7be232e.js" async=""></script><title>jinwk note</title><meta name="description" content="jinwk dev note"/><script>
              (function() {
                try {
                  const savedTheme = localStorage.getItem('theme');
                  // Default to 'dark' if no save found, ignoring system preference for now to start dark
                  const theme = savedTheme || 'dark';
                  document.documentElement.setAttribute('data-theme', theme);
                } catch (e) {}
              })();
            </script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div class="app-container"><aside class="sidebar"><div class="profile-section"><div class="profile-img-wrapper"><img src="/profile_cute.png" alt="Profile" class="profile-img"/></div><div class="profile-name" style="display:flex;align-items:center;justify-content:center;gap:0.5rem">jinwook yu<a style="font-size:0.9rem;opacity:0.5;text-decoration:none" href="/admin">⚙️</a></div><div class="profile-subtitle" style="font-size:0.9rem;color:var(--text-muted);margin-bottom:1rem">dbwlsdnr95</div><div class="profile-bio" style="white-space:pre-line;font-size:0.85rem;text-align:left;width:100%">웹·모바일 진단 ,솔루션 운영 및 클라우드 보안을 경험했고, 현재는 모의해킹·취약점 분석·CVE 연구에 집중하고 있습니다. 실전 기반 보안 역량을 꾸준히 확장하고 있습니다.</div></div><nav class="nav-section"><div class="nav-title">분류 전체보기</div><ul class="nav-list" style="margin-bottom:2rem"><li class="nav-item"><a class="" href="/">전체보기</a></li></ul><div style="margin-bottom:2rem"><div class="nav-title">교육</div><ul class="nav-list"><li class="nav-item"><a class="" href="/category/Android">Android</a></li><li class="nav-item"><a class="" href="/category/JAVA">JAVA</a></li><li class="nav-item"><a class="" href="/category/AWS">AWS</a></li></ul></div></nav></aside><main class="main-content"><article class="article-container"><div class="article-header"><span class="article-category">Android</span><h1 class="article-title">Android 보안 18일차</h1></div><div class="article-content"><h1>EQST LMS Wargame 실습 정리</h1>
<h2>1. 문제 7번 – 파일 삭제 방지 (unlink 후킹)</h2>
<h3>목적</h3>
<ul>
<li>앱이 생성한 파일을 <strong>삭제하지 못하게 막아서</strong> 내용을 확인</li>
</ul>
<h3>핵심 아이디어</h3>
<ul>
<li><code>unlink()</code> 호출 시 <strong>삭제 경로를 다른 경로로 바꿔치기</strong></li>
</ul>
<h3>Frida 코드</h3>
<pre><code>var unlinkAddr = Module.findGlobalExportByName("unlink");
console.log("unlink 주소:", unlinkAddr);

var newPathAddr = Memory.allocUtf8String("/asdf");

Interceptor.attach(unlinkAddr, {
    onEnter: function (args) {
        var delPath = args[0].readCString();
        console.log("삭제 시도 파일:", delPath);

        // 삭제 대상 경로 변경
        args[0] = newPathAddr;

        console.log("변경된 삭제 파일:", args[0].readCString());
    }
});
</code></pre>
<hr>
<h2>2. 파일 쓰기 내용 확인 (write 후킹)</h2>
<h3>목적</h3>
<ul>
<li>파일에 <strong>무슨 내용이 쓰이는지</strong> 확인</li>
</ul>
<h3>Frida 코드</h3>
<pre><code>var writeAddr = Module.findGlobalExportByName("write");
console.log("write 주소:", writeAddr);

Interceptor.attach(writeAddr, {
    onEnter: function (args) {
        // args[0] = fd
        // args[1] = buffer
        // args[2] = length
        var text = args[1].readCString();
        console.log("write 호출 내용:", text);
    }
});
</code></pre>
<hr>
<h2>3. 네트워크 해킹 개요</h2>
<h3>통신 종류</h3>
<ul>
<li><strong>HTTP</strong>
<ul>
<li>웹사이트, API, 하이브리드 앱</li>
<li>Burp Suite, Postman 사용 가능</li>
</ul>
</li>
<li><strong>TCP (Native App)</strong>
<ul>
<li>게임, 코인, 주식</li>
<li>속도 빠름, 연결 유지</li>
<li>자체 프로토콜 + 암호화</li>
</ul>
</li>
</ul>
<hr>
<h2>4. HTTP 통신 가로채기 (Burp 연동)</h2>
<h3>PC 프록시 설정</h3>
<ul>
<li>PC 인터넷 설정 → 프록시 수동 설정 (IP, Port)</li>
</ul>
<h3>Android 설정</h3>
<ul>
<li>Wi-Fi → 프록시 → 수동 → PC IP / Port</li>
</ul>
<h3>Burp 인증서 설치 (Android 6 이하)</h3>
<ol>
<li><code>https://burp/</code> 접속</li>
<li>CA 인증서 다운로드</li>
<li><code>cert.der → cert.cer</code>로 변경</li>
<li>설치</li>
</ol>
<hr>
<h2>5. Android 7 이상 HTTPS 가로채기</h2>
<h3>문제</h3>
<ul>
<li>사용자 인증서 신뢰 안 함</li>
<li>SSL Pinning 적용 앱은 Burp 무시</li>
</ul>
<h3>해결 개요</h3>
<ol>
<li>Burp 인증서를 <strong>시스템 인증서</strong>로 등록</li>
<li><code>/system/etc/security/cacerts/</code>에 설치</li>
</ol>
<h3>인증서 설치 과정</h3>
<pre><code># DER → PEM 변환
openssl x509 -inform DER -in burp.der -out burp.pem

# 해시 추출
openssl x509 -inform PEM -subject_hash_old -in burp.pem

# 파일명 변경
ren burp.pem 9a5ba575.0
# 시스템 파티션 쓰기 가능
adb shell "mount -o rw,remount /system"

# 인증서 복사
adb push 9a5ba575.0 /system/etc/security/cacerts/
</code></pre>
<ul>
<li>설정 → 보안 → 신뢰할 수 있는 자격 증명에서 <strong>Portswigger CA 활성화 확인</strong></li>
</ul>
<hr>
<h2>6. SSL Pinning 개념</h2>
<h3>구조</h3>
<pre><code>앱 → (인증서 고정) → 서버
</code></pre>
<ul>
<li>앱 내부에 서버 인증서를 <strong>하드코딩</strong></li>
<li>Burp 인증서로는 통신 불가</li>
</ul>
<h3>해결 방법</h3>
<ul>
<li><strong>Frida SSL Pinning Bypass</strong></li>
<li>Codeshare의 Universal Script 사용</li>
</ul>
<h3>간단한 Bypass 예제</h3>
<pre><code>Java.perform(function () {
    var ArrayList = Java.use("java.util.ArrayList");
    var TrustManager = Java.use("com.android.org.conscrypt.TrustManagerImpl");

    TrustManager.checkTrustedRecursive.implementation = function () {
        console.log("SSL Pinning Bypass");
        return ArrayList.$new();
    };
});
</code></pre>
<hr>
<h2>7. Android WebView 디버깅</h2>
<h3>상황</h3>
<ul>
<li>Activity + WebView 기반 앱</li>
</ul>
<h3>방법</h3>
<ul>
<li>Chrome 접속</li>
</ul>
<pre><code>chrome://inspect
</code></pre>
<ul>
<li>WebView 내부 HTML / JS 확인 가능</li>
</ul>
<hr>
<h2>8. TCP 통신 가로채기 개요</h2>
<h3>특징</h3>
<ul>
<li><code>send()</code>, <code>recv()</code> 사용</li>
<li>자체 프로토콜</li>
<li>암호화 적용 많음</li>
</ul>
<h3>예시</h3>
<pre><code>send  -> {"hash":"qwer="}
recv  -> {"result":"false"}
</code></pre>
<hr>
<h2>9. TCP → HTTP 변환 (MITMRelay)</h2>
<h3>목적</h3>
<ul>
<li><strong>TCP 통신을 HTTP처럼 Burp에서 분석</strong></li>
</ul>
<h3>구성</h3>
<pre><code>폰 → (TCP) → PC(MITMRelay) → Burp → 서버
</code></pre>
<hr>
<h2>10. iptables 리다이렉션</h2>
<h3>서버 IP 확인</h3>
<pre><code>nslookup lab.eqst.co.kr
</code></pre>
<ul>
<li>예:</li>
</ul>
<pre><code>218.233.105.178:8402
218.233.105.177:8402
</code></pre>
<h3>iptables 설정</h3>
<pre><code>iptables -A OUTPUT -t nat -p tcp -d 218.233.105.177 --dport 8402 \
-j DNAT --to-destination 192.168.35.25

iptables -A OUTPUT -t nat -p tcp -d 218.233.105.178 --dport 8402 \
-j DNAT --to-destination 192.168.35.25
</code></pre>
<hr>
<h2>11. MITMRelay 실행</h2>
<pre><code>py mitm_relay.py \
-l 192.168.35.25 \
-p 127.0.0.1:8080 \
-r tcp:8402:218.233.105.178:8402
</code></pre>
<h3>의미</h3>
<ul>
<li><code>-l</code> : 리스닝 주소 (내 PC)</li>
<li><code>-p</code> : Burp 프록시 주소</li>
<li><code>-r</code> : 실제 서버로 전달할 목적지</li>
</ul>
<hr>
<h2>12. 문제 6번 – TCP JSON 데이터</h2>
<h3>전송 데이터</h3>
<pre><code>{
  "os": "android",
  "Qno": "andtcp1",
  "id": "1234",
  "pw": "1234"
}
</code></pre>
<h3>목표</h3>
<ul>
<li>Burp에서 JSON 수정</li>
<li>서버 응답 변화 확인</li>
</ul>
<hr>
<h2>13. 핵심 요약</h2>
<ul>
<li><code>unlink()</code> 후킹 → 파일 삭제 방지</li>
<li><code>write()</code> 후킹 → 파일 내용 확인</li>
<li>HTTP → Burp 직접 분석</li>
<li>HTTPS → 시스템 인증서 + SSL Pinning 우회</li>
<li>TCP → iptables + MITMRelay + Burp</li>
<li>Native 통신은 <strong>Frida + 네트워크 우회</strong> 병행 필요</li>
</ul>
</div></article></main></div><script src="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/fff7d7d50ba66cff.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n6:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[8383,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"185\",\"static/chunks/app/layout-10c7e025b6149e17.js\"],\"\"]\nb:I[5250,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"931\",\"static/chunks/app/page-e31ae51de7be232e.js\"],\"\"]\nd:I[8955,[],\"\"]\n7:[\"category\",\"Android\",\"d\"]\n8:[\"slug\",\"day18\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fff7d7d50ba66cff.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"TRFLD1MljlsxO-bl3YPbV\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/Android/day18\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day18\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"Android\\\",\\\"slug\\\":\\\"day18\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day18\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n              (function() {\\n                try {\\n                  const savedTheme = localStorage.getItem('theme');\\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\\n                  const theme = savedTheme || 'dark';\\n                  document.documentElement.setAttribute('data-theme', theme);\\n                } catch (e) {}\\n              })();\\n            \"}}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"app-container\",\"children\":[[\"$\",\"$La\",null,{\"categories\":[\"AWS\",\"Android\",\"JAVA\"]}],[\"$\",\"main\",null,{\"className\":\"main-content\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center min-h-[60vh] text-center px-4\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-4xl font-bold mb-4\",\"children\":\"404 - Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-500 mb-8\",\"children\":\"요청하신 페이지를 찾을 수 없습니다.\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"className\":\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition\",\"children\":\"홈으로 돌아가기\"}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}]}]]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"f:T1863,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eEQST LMS Wargame 실습 정리\u003c/h1\u003e\n\u003ch2\u003e1. 문제 7번 – 파일 삭제 방지 (unlink 후킹)\u003c/h2\u003e\n\u003ch3\u003e목적\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e앱이 생성한 파일을 \u003cstrong\u003e삭제하지 못하게 막아서\u003c/strong\u003e 내용을 확인\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e핵심 아이디어\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunlink()\u003c/code\u003e 호출 시 \u003cstrong\u003e삭제 경로를 다른 경로로 바꿔치기\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFrida 코드\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003evar unlinkAddr = Module.findGlobalExportByName(\"unlink\");\r\nconsole.log(\"unlink 주소:\", unlinkAddr);\r\n\r\nvar newPathAddr = Memory.allocUtf8String(\"/asdf\");\r\n\r\nInterceptor.attach(unlinkAddr, {\r\n    onEnter: function (args) {\r\n        var delPath = args[0].readCString();\r\n        console.log(\"삭제 시도 파일:\", delPath);\r\n\r\n        // 삭제 대상 경로 변경\r\n        args[0] = newPathAddr;\r\n\r\n        console.log(\"변경된 삭제 파일:\", args[0].readCString());\r\n    }\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e2. 파일 쓰기 내용 확인 (write 후킹)\u003c/h2\u003e\n\u003ch3\u003e목적\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e파일에 \u003cstrong\u003e무슨 내용이 쓰이는지\u003c/strong\u003e 확인\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFrida 코드\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003evar writeAddr = Module.findGlobalExportByName(\"write\");\r\nconsole.log(\"write 주소:\", writeAddr);\r\n\r\nInterceptor.attach(writeAddr, {\r\n    onEnter: function (args) {\r\n        // args[0] = fd\r\n        // args[1] = buffer\r\n        // args[2] = length\r\n        var text = args[1].readCString();\r\n        console.log(\"write 호출 내용:\", text);\r\n    }\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e3. 네트워크 해킹 개요\u003c/h2\u003e\n\u003ch3\u003e통신 종류\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eHTTP\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e웹사이트, API, 하이브리드 앱\u003c/li\u003e\n\u003cli\u003eBurp Suite, Postman 사용 가능\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTCP (Native App)\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e게임, 코인, 주식\u003c/li\u003e\n\u003cli\u003e속도 빠름, 연결 유지\u003c/li\u003e\n\u003cli\u003e자체 프로토콜 + 암호화\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e4. HTTP 통신 가로채기 (Burp 연동)\u003c/h2\u003e\n\u003ch3\u003ePC 프록시 설정\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePC 인터넷 설정 → 프록시 수동 설정 (IP, Port)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eAndroid 설정\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eWi-Fi → 프록시 → 수동 → PC IP / Port\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eBurp 인증서 설치 (Android 6 이하)\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003ehttps://burp/\u003c/code\u003e 접속\u003c/li\u003e\n\u003cli\u003eCA 인증서 다운로드\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecert.der → cert.cer\u003c/code\u003e로 변경\u003c/li\u003e\n\u003cli\u003e설치\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2\u003e5. Android 7 이상 HTTPS 가로채기\u003c/h2\u003e\n\u003ch3\u003e문제\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e사용자 인증서 신뢰 안 함\u003c/li\u003e\n\u003cli\u003eSSL Pinning 적용 앱은 Burp 무시\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e해결 개요\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eBurp 인증서를 \u003cstrong\u003e시스템 인증서\u003c/strong\u003e로 등록\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/system/etc/security/cacerts/\u003c/code\u003e에 설치\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e인증서 설치 과정\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e# DER → PEM 변환\r\nopenssl x509 -inform DER -in burp.der -out burp.pem\r\n\r\n# 해시 추출\r\nopenssl x509 -inform PEM -subject_hash_old -in burp.pem\r\n\r\n# 파일명 변경\r\nren burp.pem 9a5ba575.0\r\n# 시스템 파티션 쓰기 가능\r\nadb shell \"mount -o rw,remount /system\"\r\n\r\n# 인증서 복사\r\nadb push 9a5ba575.0 /system/etc/security/cacerts/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e설정 → 보안 → 신뢰할 수 있는 자격 증명에서 \u003cstrong\u003ePortswigger CA 활성화 확인\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e6. SSL Pinning 개념\u003c/h2\u003e\n\u003ch3\u003e구조\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e앱 → (인증서 고정) → 서버\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e앱 내부에 서버 인증서를 \u003cstrong\u003e하드코딩\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eBurp 인증서로는 통신 불가\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e해결 방법\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eFrida SSL Pinning Bypass\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eCodeshare의 Universal Script 사용\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e간단한 Bypass 예제\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    var ArrayList = Java.use(\"java.util.ArrayList\");\r\n    var TrustManager = Java.use(\"com.android.org.conscrypt.TrustManagerImpl\");\r\n\r\n    TrustManager.checkTrustedRecursive.implementation = function () {\r\n        console.log(\"SSL Pinning Bypass\");\r\n        return ArrayList.$new();\r\n    };\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e7. Android WebView 디버깅\u003c/h2\u003e\n\u003ch3\u003e상황\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eActivity + WebView 기반 앱\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e방법\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eChrome 접속\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003echrome://inspect\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eWebView 내부 HTML / JS 확인 가능\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e8. TCP 통신 가로채기 개요\u003c/h2\u003e\n\u003ch3\u003e특징\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003esend()\u003c/code\u003e, \u003ccode\u003erecv()\u003c/code\u003e 사용\u003c/li\u003e\n\u003cli\u003e자체 프로토콜\u003c/li\u003e\n\u003cli\u003e암호화 적용 많음\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e예시\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003esend  -\u003e {\"hash\":\"qwer=\"}\r\nrecv  -\u003e {\"result\":\"false\"}\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e9. TCP → HTTP 변환 (MITMRelay)\u003c/h2\u003e\n\u003ch3\u003e목적\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eTCP 통신을 HTTP처럼 Burp에서 분석\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e구성\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e폰 → (TCP) → PC(MITMRelay) → Burp → 서버\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e10. iptables 리다이렉션\u003c/h2\u003e\n\u003ch3\u003e서버 IP 확인\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003enslookup lab.eqst.co.kr\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e예:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e218.233.105.178:8402\r\n218.233.105.177:8402\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eiptables 설정\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eiptables -A OUTPUT -t nat -p tcp -d 218.233.105.177 --dport 8402 \\\r\n-j DNAT --to-destination 192.168.35.25\r\n\r\niptables -A OUTPUT -t nat -p tcp -d 218.233.105.178 --dport 8402 \\\r\n-j DNAT --to-destination 192.168.35.25\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e11. MITMRelay 실행\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003epy mitm_relay.py \\\r\n-l 192.168.35.25 \\\r\n-p 127.0.0.1:8080 \\\r\n-r tcp:8402:218.233.105.178:8402\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e의미\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-l\u003c/code\u003e : 리스닝 주소 (내 PC)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p\u003c/code\u003e : Burp 프록시 주소\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-r\u003c/code\u003e : 실제 서버로 전달할 목적지\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e12. 문제 6번 – TCP JSON 데이터\u003c/h2\u003e\n\u003ch3\u003e전송 데이터\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e{\r\n  \"os\": \"android\",\r\n  \"Qno\": \"andtcp1\",\r\n  \"id\": \"1234\",\r\n  \"pw\": \"1234\"\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e목표\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eBurp에서 JSON 수정\u003c/li\u003e\n\u003cli\u003e서버 응답 변화 확인\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e13. 핵심 요약\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunlink()\u003c/code\u003e 후킹 → 파일 삭제 방지\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewrite()\u003c/code\u003e 후킹 → 파일 내용 확인\u003c/li\u003e\n\u003cli\u003eHTTP → Burp 직접 분석\u003c/li\u003e\n\u003cli\u003eHTTPS → 시스템 인증서 + SSL Pinning 우회\u003c/li\u003e\n\u003cli\u003eTCP → iptables + MITMRelay + Burp\u003c/li\u003e\n\u003cli\u003eNative 통신은 \u003cstrong\u003eFrida + 네트워크 우회\u003c/strong\u003e 병행 필요\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"className\":\"article-container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article-header\",\"children\":[[\"$\",\"span\",null,{\"className\":\"article-category\",\"children\":\"Android\"}],[\"$\",\"h1\",null,{\"className\":\"article-title\",\"children\":\"Android 보안 18일차\"}]]}],[\"$\",\"div\",null,{\"className\":\"article-content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$f\"}}]]}]\nc:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"titl"])</script><script>self.__next_f.push([1,"e\",\"2\",{\"children\":\"jinwk note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"jinwk dev note\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>