3:I[5613,[],""]
6:I[1778,[],""]
7:I[8383,["250","static/chunks/250-069982e43c2ae463.js","185","static/chunks/app/layout-10c7e025b6149e17.js"],""]
8:I[5250,["250","static/chunks/250-069982e43c2ae463.js","931","static/chunks/app/page-e31ae51de7be232e.js"],""]
4:["category","Android","d"]
5:["slug","day18","d"]
0:["16MaIM6sfU5RrcCsiLE0O",[[["",{"children":["post",{"children":[["category","Android","d"],{"children":[["slug","day18","d"],{"children":["__PAGE__?{\"category\":\"Android\",\"slug\":\"day18\"}",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["post",{"children":[["category","Android","d"],{"children":[["slug","day18","d"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children","$4","children","$5","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"ko","suppressHydrationWarning":true,"children":[["$","head",null,{"children":["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\n              (function() {\n                try {\n                  const savedTheme = localStorage.getItem('theme');\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\n                  const theme = savedTheme || 'dark';\n                  document.documentElement.setAttribute('data-theme', theme);\n                } catch (e) {}\n              })();\n            "}}]}],["$","body",null,{"children":["$","div",null,{"className":"app-container","children":[["$","$L7",null,{"categories":["AWS","Android","JAVA"]}],["$","main",null,{"className":"main-content","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-center justify-center min-h-[60vh] text-center px-4","children":[["$","h2",null,{"className":"text-4xl font-bold mb-4","children":"404 - Not Found"}],["$","p",null,{"className":"text-gray-500 mb-8","children":"요청하신 페이지를 찾을 수 없습니다."}],["$","$L8",null,{"href":"/","className":"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition","children":"홈으로 돌아가기"}]]}],"notFoundStyles":[],"styles":null}]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/fff7d7d50ba66cff.css","precedence":"next","crossOrigin":""}]],"$L9"]]]]
a:T1863,<h1>EQST LMS Wargame 실습 정리</h1>
<h2>1. 문제 7번 – 파일 삭제 방지 (unlink 후킹)</h2>
<h3>목적</h3>
<ul>
<li>앱이 생성한 파일을 <strong>삭제하지 못하게 막아서</strong> 내용을 확인</li>
</ul>
<h3>핵심 아이디어</h3>
<ul>
<li><code>unlink()</code> 호출 시 <strong>삭제 경로를 다른 경로로 바꿔치기</strong></li>
</ul>
<h3>Frida 코드</h3>
<pre><code>var unlinkAddr = Module.findGlobalExportByName("unlink");
console.log("unlink 주소:", unlinkAddr);

var newPathAddr = Memory.allocUtf8String("/asdf");

Interceptor.attach(unlinkAddr, {
    onEnter: function (args) {
        var delPath = args[0].readCString();
        console.log("삭제 시도 파일:", delPath);

        // 삭제 대상 경로 변경
        args[0] = newPathAddr;

        console.log("변경된 삭제 파일:", args[0].readCString());
    }
});
</code></pre>
<hr>
<h2>2. 파일 쓰기 내용 확인 (write 후킹)</h2>
<h3>목적</h3>
<ul>
<li>파일에 <strong>무슨 내용이 쓰이는지</strong> 확인</li>
</ul>
<h3>Frida 코드</h3>
<pre><code>var writeAddr = Module.findGlobalExportByName("write");
console.log("write 주소:", writeAddr);

Interceptor.attach(writeAddr, {
    onEnter: function (args) {
        // args[0] = fd
        // args[1] = buffer
        // args[2] = length
        var text = args[1].readCString();
        console.log("write 호출 내용:", text);
    }
});
</code></pre>
<hr>
<h2>3. 네트워크 해킹 개요</h2>
<h3>통신 종류</h3>
<ul>
<li><strong>HTTP</strong>
<ul>
<li>웹사이트, API, 하이브리드 앱</li>
<li>Burp Suite, Postman 사용 가능</li>
</ul>
</li>
<li><strong>TCP (Native App)</strong>
<ul>
<li>게임, 코인, 주식</li>
<li>속도 빠름, 연결 유지</li>
<li>자체 프로토콜 + 암호화</li>
</ul>
</li>
</ul>
<hr>
<h2>4. HTTP 통신 가로채기 (Burp 연동)</h2>
<h3>PC 프록시 설정</h3>
<ul>
<li>PC 인터넷 설정 → 프록시 수동 설정 (IP, Port)</li>
</ul>
<h3>Android 설정</h3>
<ul>
<li>Wi-Fi → 프록시 → 수동 → PC IP / Port</li>
</ul>
<h3>Burp 인증서 설치 (Android 6 이하)</h3>
<ol>
<li><code>https://burp/</code> 접속</li>
<li>CA 인증서 다운로드</li>
<li><code>cert.der → cert.cer</code>로 변경</li>
<li>설치</li>
</ol>
<hr>
<h2>5. Android 7 이상 HTTPS 가로채기</h2>
<h3>문제</h3>
<ul>
<li>사용자 인증서 신뢰 안 함</li>
<li>SSL Pinning 적용 앱은 Burp 무시</li>
</ul>
<h3>해결 개요</h3>
<ol>
<li>Burp 인증서를 <strong>시스템 인증서</strong>로 등록</li>
<li><code>/system/etc/security/cacerts/</code>에 설치</li>
</ol>
<h3>인증서 설치 과정</h3>
<pre><code># DER → PEM 변환
openssl x509 -inform DER -in burp.der -out burp.pem

# 해시 추출
openssl x509 -inform PEM -subject_hash_old -in burp.pem

# 파일명 변경
ren burp.pem 9a5ba575.0
# 시스템 파티션 쓰기 가능
adb shell "mount -o rw,remount /system"

# 인증서 복사
adb push 9a5ba575.0 /system/etc/security/cacerts/
</code></pre>
<ul>
<li>설정 → 보안 → 신뢰할 수 있는 자격 증명에서 <strong>Portswigger CA 활성화 확인</strong></li>
</ul>
<hr>
<h2>6. SSL Pinning 개념</h2>
<h3>구조</h3>
<pre><code>앱 → (인증서 고정) → 서버
</code></pre>
<ul>
<li>앱 내부에 서버 인증서를 <strong>하드코딩</strong></li>
<li>Burp 인증서로는 통신 불가</li>
</ul>
<h3>해결 방법</h3>
<ul>
<li><strong>Frida SSL Pinning Bypass</strong></li>
<li>Codeshare의 Universal Script 사용</li>
</ul>
<h3>간단한 Bypass 예제</h3>
<pre><code>Java.perform(function () {
    var ArrayList = Java.use("java.util.ArrayList");
    var TrustManager = Java.use("com.android.org.conscrypt.TrustManagerImpl");

    TrustManager.checkTrustedRecursive.implementation = function () {
        console.log("SSL Pinning Bypass");
        return ArrayList.$new();
    };
});
</code></pre>
<hr>
<h2>7. Android WebView 디버깅</h2>
<h3>상황</h3>
<ul>
<li>Activity + WebView 기반 앱</li>
</ul>
<h3>방법</h3>
<ul>
<li>Chrome 접속</li>
</ul>
<pre><code>chrome://inspect
</code></pre>
<ul>
<li>WebView 내부 HTML / JS 확인 가능</li>
</ul>
<hr>
<h2>8. TCP 통신 가로채기 개요</h2>
<h3>특징</h3>
<ul>
<li><code>send()</code>, <code>recv()</code> 사용</li>
<li>자체 프로토콜</li>
<li>암호화 적용 많음</li>
</ul>
<h3>예시</h3>
<pre><code>send  -> {"hash":"qwer="}
recv  -> {"result":"false"}
</code></pre>
<hr>
<h2>9. TCP → HTTP 변환 (MITMRelay)</h2>
<h3>목적</h3>
<ul>
<li><strong>TCP 통신을 HTTP처럼 Burp에서 분석</strong></li>
</ul>
<h3>구성</h3>
<pre><code>폰 → (TCP) → PC(MITMRelay) → Burp → 서버
</code></pre>
<hr>
<h2>10. iptables 리다이렉션</h2>
<h3>서버 IP 확인</h3>
<pre><code>nslookup lab.eqst.co.kr
</code></pre>
<ul>
<li>예:</li>
</ul>
<pre><code>218.233.105.178:8402
218.233.105.177:8402
</code></pre>
<h3>iptables 설정</h3>
<pre><code>iptables -A OUTPUT -t nat -p tcp -d 218.233.105.177 --dport 8402 \
-j DNAT --to-destination 192.168.35.25

iptables -A OUTPUT -t nat -p tcp -d 218.233.105.178 --dport 8402 \
-j DNAT --to-destination 192.168.35.25
</code></pre>
<hr>
<h2>11. MITMRelay 실행</h2>
<pre><code>py mitm_relay.py \
-l 192.168.35.25 \
-p 127.0.0.1:8080 \
-r tcp:8402:218.233.105.178:8402
</code></pre>
<h3>의미</h3>
<ul>
<li><code>-l</code> : 리스닝 주소 (내 PC)</li>
<li><code>-p</code> : Burp 프록시 주소</li>
<li><code>-r</code> : 실제 서버로 전달할 목적지</li>
</ul>
<hr>
<h2>12. 문제 6번 – TCP JSON 데이터</h2>
<h3>전송 데이터</h3>
<pre><code>{
  "os": "android",
  "Qno": "andtcp1",
  "id": "1234",
  "pw": "1234"
}
</code></pre>
<h3>목표</h3>
<ul>
<li>Burp에서 JSON 수정</li>
<li>서버 응답 변화 확인</li>
</ul>
<hr>
<h2>13. 핵심 요약</h2>
<ul>
<li><code>unlink()</code> 후킹 → 파일 삭제 방지</li>
<li><code>write()</code> 후킹 → 파일 내용 확인</li>
<li>HTTP → Burp 직접 분석</li>
<li>HTTPS → 시스템 인증서 + SSL Pinning 우회</li>
<li>TCP → iptables + MITMRelay + Burp</li>
<li>Native 통신은 <strong>Frida + 네트워크 우회</strong> 병행 필요</li>
</ul>
2:["$","article",null,{"className":"article-container","children":[["$","div",null,{"className":"article-header","children":[["$","span",null,{"className":"article-category","children":"Android"}],["$","h1",null,{"className":"article-title","children":"Android 보안 18일차"}]]}],["$","div",null,{"className":"article-content","dangerouslySetInnerHTML":{"__html":"$a"}}]]}]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"jinwk note"}],["$","meta","3",{"name":"description","content":"jinwk dev note"}]]
1:null
