3:I[5613,[],""]
6:I[1778,[],""]
7:I[8383,["250","static/chunks/250-069982e43c2ae463.js","185","static/chunks/app/layout-ada0ccfdc2732042.js"],""]
4:["category","Android","d"]
5:["slug","day8","d"]
0:["Abs63gimMocH9GC6KfM8u",[[["",{"children":["post",{"children":[["category","Android","d"],{"children":[["slug","day8","d"],{"children":["__PAGE__?{\"category\":\"Android\",\"slug\":\"day8\"}",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["post",{"children":[["category","Android","d"],{"children":[["slug","day8","d"],{"children":["__PAGE__",{},["$L1","$L2",null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children","$4","children","$5","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","post","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"ko","suppressHydrationWarning":true,"children":[["$","head",null,{"children":["$","script",null,{"dangerouslySetInnerHTML":{"__html":"\n              (function() {\n                try {\n                  const savedTheme = localStorage.getItem('theme');\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\n                  const theme = savedTheme || 'dark';\n                  document.documentElement.setAttribute('data-theme', theme);\n                } catch (e) {}\n              })();\n            "}}]}],["$","body",null,{"children":["$","div",null,{"className":"app-container","children":[["$","$L7",null,{"categories":["AWS","Android","JAVA"]}],["$","main",null,{"className":"main-content","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}]]}]}]]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/fff7d7d50ba66cff.css","precedence":"next","crossOrigin":""}]],"$L8"]]]]
9:T14f0,<h1>정적 분석 정리 (Crypto · Smali · APK 변조)</h1>
<hr>
<h2>정적분석 4번 — AES/CBC 기반 암호화 구조 분석</h2>
<h3>1. 암호화 로직 구조</h3>
<ul>
<li>암호화 알고리즘
<ul>
<li><code>AES/CBC/PKCS5Padding</code></li>
</ul>
</li>
<li>암호화 키
<ul>
<li>문자열: <code>0123456789abcdef</code></li>
<li>바이트 배열 변환 → <code>bArr</code></li>
</ul>
</li>
<li>IV (Initialization Vector)
<ul>
<li><code>bArr2</code></li>
<li>16바이트 랜덤 값</li>
</ul>
</li>
<li>평문 암호화
<ul>
<li><code>bArrDoFinal = AES.encrypt(plaintext, key=bArr, iv=bArr2)</code></li>
</ul>
</li>
</ul>
<hr>
<h3>2. 최종 암호문 포맷</h3>
<pre><code>Base64( IV(16바이트) + CipherText )
</code></pre>
<ul>
<li><code>strEncodeToString</code>
→ <code>bArr2 + bArrDoFinal</code>을 Base64 인코딩한 문자열</li>
</ul>
<hr>
<h3>3. 복호화 절차</h3>
<ol>
<li>Base64 디코딩</li>
<li>앞 16바이트 분리 → IV</li>
<li>나머지 바이트 → 암호문</li>
<li>AES/CBC/PKCS5Padding 복호화</li>
<li>원문 획득</li>
</ol>
<hr>
<h3>4. 실제 분석 데이터</h3>
<h4>저장 위치</h4>
<pre><code>/data/data/패키지명/shared_prefs/app_prefs.xml
</code></pre>
<h4>암호화된 플래그</h4>
<pre><code>iDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY
</code></pre>
<hr>
<h3>5. Base64 디코딩 결과 (Hex)</h3>
<pre><code>88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d
a7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33
12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98
</code></pre>
<ul>
<li>IV (16바이트)</li>
</ul>
<pre><code>88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d
</code></pre>
<ul>
<li>암호문</li>
</ul>
<pre><code>a7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33
12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98
</code></pre>
<hr>
<h3>6. 복호화 정보 요약</h3>
<p>| 항목     | 값                   |
| -------- | -------------------- |
| 알고리즘 | AES/CBC/PKCS5Padding |
| 키       | 0123456789abcdef     |
| IV       | 앞 16바이트          |
| 암호문   | 나머지 바이트        |
| 결과     | 평문 플래그          |</p>
<hr>
<h2>정적분석 5번 — AES/GCM + PBKDF2 구조 분석</h2>
<hr>
<h3>1. 암호화 흐름</h3>
<pre><code>encrypt(평문)
 → encrypt(평문, "eqst_lms")
</code></pre>
<hr>
<h3>2. 난수 값 생성</h3>
<ul>
<li><code>bArr[16]</code>
<ul>
<li>16바이트 랜덤 Salt</li>
</ul>
</li>
<li><code>bArr2[12]</code>
<ul>
<li>12바이트 랜덤 IV</li>
</ul>
</li>
</ul>
<hr>
<h3>3. 키 파생 (Key Derivation)</h3>
<pre><code>PBEKeySpec("eqst_lms", salt, 150000, 256)
</code></pre>
<ul>
<li>알고리즘
<ul>
<li>PBKDF2WithHmacSHA256</li>
<li>(일부 구현에서는 PBKDF2WithHmacSHA1 사용)</li>
</ul>
</li>
</ul>
<hr>
<h3>4. 암호화 알고리즘</h3>
<ul>
<li><code>AES/GCM/NoPadding</code></li>
<li><code>GCMParameterSpec(128, bArr2)</code></li>
</ul>
<hr>
<h3>5. 최종 암호문 포맷</h3>
<pre><code>01 | Salt(16) | IV(12) | CipherText | GCM Tag
</code></pre>
<ul>
<li>전체를 Base64 인코딩하여 반환</li>
</ul>
<hr>
<h3>6. 암호문 예시</h3>
<pre><code>AZ/oUGgQWbCw9isMhikWIkSrSfGQuG+YU82+0jgKjb0bGfwtRWmne9Wku1y7Tyg/c99gKAYGPuIAvTVfdg==
</code></pre>
<hr>
<h3>7. Base64 디코딩 결과 (Hex)</h3>
<pre><code>01
9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44
ab 49 f1 90 b8 6f 98 53 cd be d2 38
0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb
4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76
</code></pre>
<hr>
<h3>8. 데이터 분리</h3>
<ul>
<li>버전</li>
</ul>
<pre><code>01
</code></pre>
<ul>
<li>Salt (16바이트)</li>
</ul>
<pre><code>9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44
</code></pre>
<ul>
<li>IV (12바이트)</li>
</ul>
<pre><code>ab 49 f1 90 b8 6f 98 53 cd be d2 38
</code></pre>
<ul>
<li>암호문</li>
</ul>
<pre><code>0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb
</code></pre>
<ul>
<li>GCM Tag</li>
</ul>
<pre><code>4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76
</code></pre>
<hr>
<h2>Smali 코드 분석 및 APK 변조</h2>
<hr>
<h3>Smali 분석 특징</h3>
<ul>
<li>dex → smali 변조 가능</li>
<li>Java 코드 직접 변조는 불가</li>
<li>smali 수정 후 재빌드 필요</li>
</ul>
<hr>
<h3>APK 변조 흐름</h3>
<ol>
<li>APK 디컴파일</li>
<li>Java 코드 기준으로 로직 분석</li>
<li>대응되는 <code>.smali</code> 코드 탐색</li>
<li>smali 코드 직접 수정</li>
<li>재빌드 및 재서명</li>
<li>설치 후 실행</li>
</ol>
<hr>
<h3>Activity 실행</h3>
<pre><code>am start 액티비티이름
</code></pre>
<hr>
<h3>CPU ABI 확인</h3>
<pre><code>Build.CPU_ABI
</code></pre>
<ul>
<li>예: <code>arm64-v8a</code>, <code>x86_64</code></li>
</ul>
<hr>
<h3>Smali 조건 분기 정리</h3>
<pre><code>if-eq v0, v1      같으면 분기
if-neq v0, v1     다르면 분기
if-eqz v0         v0 == 0
if-nez v0         v0 != 0
if-lt v0, v1      v0 &#x3C; v1
if-le v0, v1      v0 &#x3C;= v1
if-gt v0, v1      v0 > v1
if-ge v0, v1      v0 >= v1
if-ltz v0         v0 &#x3C; 0
if-lez v0         v0 &#x3C;= 0
if-gtz v0         v0 > 0
if-gez v0         v0 >= 0
</code></pre>
<hr>
<h3>CRC 무결성 확인</h3>
<ul>
<li>원본 APK <code>classes.dex</code> CRC</li>
</ul>
<pre><code>1302005358
</code></pre>
<ul>
<li>변조된 APK <code>classes.dex</code> CRC</li>
</ul>
<pre><code>2993910671
</code></pre>
2:["$","article",null,{"className":"article-container","children":[["$","div",null,{"className":"article-header","children":[["$","span",null,{"className":"article-category","children":"Android"}],["$","h1",null,{"className":"article-title","children":"Android 보안 8일차"}]]}],["$","div",null,{"className":"article-content","dangerouslySetInnerHTML":{"__html":"$9"}}]]}]
8:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"jinwk note"}],["$","meta","3",{"name":"description","content":"jinwk dev note"}]]
1:null
