<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/profile_cute.png"/><link rel="stylesheet" href="/_next/static/css/fff7d7d50ba66cff.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-c50cb70e7323352b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-f8546037c2082669.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-baff347ce7e39457.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-069982e43c2ae463.js" async=""></script><script src="/_next/static/chunks/app/layout-ada0ccfdc2732042.js" async=""></script><title>jinwk note</title><meta name="description" content="jinwk dev note"/><script>
              (function() {
                try {
                  const savedTheme = localStorage.getItem('theme');
                  // Default to 'dark' if no save found, ignoring system preference for now to start dark
                  const theme = savedTheme || 'dark';
                  document.documentElement.setAttribute('data-theme', theme);
                } catch (e) {}
              })();
            </script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div class="app-container"><aside class="sidebar"><div class="profile-section"><div class="profile-img-wrapper"><img src="/profile_cute.png" alt="Profile" class="profile-img"/></div><div class="profile-name" style="display:flex;align-items:center;justify-content:center;gap:0.5rem">jinwook yu<a style="font-size:0.9rem;opacity:0.5;text-decoration:none" href="/admin">⚙️</a></div><div class="profile-subtitle" style="font-size:0.9rem;color:var(--text-muted);margin-bottom:1rem">dbwlsdnr95</div><div class="profile-bio" style="white-space:pre-line;font-size:0.85rem;text-align:left;width:100%">웹·모바일 진단 ,솔루션 운영 및 클라우드 보안을 경험했고, 현재는 모의해킹·취약점 분석·CVE 연구에 집중하고 있습니다. 실전 기반 보안 역량을 꾸준히 확장하고 있습니다.</div></div><nav class="nav-section"><div class="nav-title">분류 전체보기</div><ul class="nav-list" style="margin-bottom:2rem"><li class="nav-item"><a class="" href="/">전체보기</a></li></ul><div style="margin-bottom:2rem"><div class="nav-title">교육</div><ul class="nav-list"><li class="nav-item"><a class="" href="/category/Android">Android</a></li><li class="nav-item"><a class="" href="/category/JAVA">JAVA</a></li><li class="nav-item"><a class="" href="/category/AWS">AWS</a></li></ul></div></nav></aside><main class="main-content"><article class="article-container"><div class="article-header"><span class="article-category">Android</span><h1 class="article-title">Android 보안 12일차</h1></div><div class="article-content"><p>Frida Labs 직접 실습</p>
<h2>Challenge 풀이 요약</h2>
<h3>1️⃣ chall01</h3>
<ul>
<li>
<p>대상 클래스: <code>challenge_01.chall01</code></p>
</li>
<li>
<p>내부 필드 값을 직접 수정하여 <strong>값을 1로 설정</strong></p>
</li>
<li>
<p>함수 호출 없이 필드 조작만으로 해결</p>
<pre><code>Java.perform(() => {
    var chall01 = Java.use("uk.rossmarks.fridalab.challenge_01");
    chall01.chall01.value = 1;
});
</code></pre>
</li>
</ul>
<hr>
<h3>2️⃣ chall02</h3>
<ul>
<li>
<p><code>MainActivity</code> 인스턴스를 찾아</p>
</li>
<li>
<p><code>chall02()</code> 메서드를 <strong>직접 호출</strong></p>
</li>
<li>
<p>파라미터 없이 호출 시 자동으로 완료</p>
<pre><code>Java.perform(function () {
    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch: function (instance) {
            instance.chall02();
        },
        onComplete: function () { }
    });
});
</code></pre>
</li>
</ul>
<hr>
<h3>3️⃣ chall03</h3>
<ul>
<li>
<p>대상 메서드: <code>MainActivity.chall03()</code></p>
</li>
<li>
<p>반환값을 항상 <code>true</code>로 <strong>후킹하여 고정</strong></p>
</li>
<li>
<p>로직 무시 방식</p>
<pre><code>Java.perform(() => {
   var MainActivity = Java.use("uk.rossmarks.fridalab.MainActivity");
    MainActivity.chall03.implementation = function () {
        return true;
};
});
</code></pre>
</li>
</ul>
<hr>
<h3>4️⃣ chall04</h3>
<ul>
<li>
<p><code>MainActivity.chall04("frida")</code> 호출</p>
</li>
<li>
<p>문자열 비교 로직을 만족하도록 <strong>입력값 조작</strong></p>
</li>
<li>
<p>인자 값 <code>"frida"</code> 전달로 해결</p>
<pre><code>Java.perform(() => {
    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch(instance) {
            instance.chall04("frida");
        },
        onComplete() {}
    });
});
</code></pre>
</li>
</ul>
<hr>
<h3>5️⃣ chall05</h3>
<ul>
<li>
<p><code>MainActivity.chall05</code> 메서드 후킹</p>
</li>
<li>
<p>어떤 입력이 오더라도 내부에서 <code>"frida"</code>로 치환</p>
</li>
<li>
<p>입력 무력화 방식</p>
<pre><code>Java.perform(() => {
    var MainActivity = Java.use("uk.rossmarks.fridalab.MainActivity");

    MainActivity.chall05.implementation = function (str) {
        return this.chall05("frida");
    };
});
</code></pre>
</li>
</ul>
<hr>
<h3>6️⃣ chall06</h3>
<ul>
<li>
<p>앱 실행 후 <strong>10초 대기 (총 11초 이상)</strong></p>
</li>
<li>
<p><code>challenge_06.chall06</code> 내부 값 읽기</p>
</li>
<li>
<p>해당 값을 <code>MainActivity.chall06(value)</code>로 전달</p>
</li>
<li>
<p><strong>타이밍 + 값 추출</strong> 조합 문제</p>
<pre><code>Java.perform(() => {
    setTimeout(function () {
        const Challenge06 = Java.use("uk.rossmarks.fridalab.challenge_06");
        Java.choose("uk.rossmarks.fridalab.MainActivity", {
            onMatch(instance) {
                const value = Challenge06.chall06.value;
                instance.chall06(value);
            },
            onComplete() {}
        });
    }, 11000);
});
</code></pre>
</li>
</ul>
<hr>
<h3>7️⃣ chall07</h3>
<ul>
<li>
<p>PIN 코드 <strong>0000 ~ 9999 전체 브루트포스</strong></p>
</li>
<li>
<p><code>chall07(pin)</code> 반복 호출</p>
</li>
<li>
<p>성공 조건:</p>
<pre><code>completeArr[6] === 1
</code></pre>
</li>
<li>
<p>자동화 스크립트로 해결</p>
<pre><code>Java.perform(() => {
    setTimeout(() => {
        Java.choose("uk.rossmarks.fridalab.MainActivity", {
            onMatch(instance) {

                for (let i = 0; i &#x3C;= 9999; i++) {
                    const pin = ("0000" + i).slice(-4);

                    instance.chall07(pin);

                    if (instance.completeArr.value[6] === 1) {
                        console.log("[비밀번호 확인] =", pin);
                        break;
                    }
                }

            },
            onComplete() {}
        });
    }, 1000);
});
</code></pre>
</li>
</ul>
<hr>
<h3>8️⃣ chall08</h3>
<ul>
<li>
<p>버튼 ID: <code>check</code></p>
</li>
<li>
<p>버튼 텍스트를 <code>"Confirm"</code>으로 변경</p>
</li>
<li>
<p>이후 <code>chall08()</code> 메서드 호출</p>
</li>
<li>
<p><strong>UI 조작 + 함수 호출</strong> 문제</p>
<pre><code>Java.perform(() => {
    const Button = Java.use("android.widget.Button");
    const JString = Java.use("java.lang.String");
    const checkId = Java.use("uk.rossmarks.fridalab.R$id").check.value;

    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch(instance) {
            const view = instance.findViewById(checkId);
            if (!view) return;

            const btn = Java.cast(view, Button);
            btn.setText(JString.$new("Confirm"));
        },
        onComplete() {}
    });
});
</code></pre>
</li>
</ul>
<p>9️⃣ 전체 합친 코드</p>
<pre><code>// challenge 1
Java.perform(() => {
    var chall01 = Java.use("uk.rossmarks.fridalab.challenge_01");
    chall01.chall01.value = 1;
});

// challenge 2
Java.perform(function () {
    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch: function (instance) {
            instance.chall02();
        },
        onComplete: function () { }
    });
});

// challenge 3
Java.perform(() => {
   var MainActivity = Java.use("uk.rossmarks.fridalab.MainActivity");
    MainActivity.chall03.implementation = function () {
        return true;
};
});

// challenge 4
Java.perform(() => {
    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch(instance) {
            instance.chall04("frida");
        },
        onComplete() {}
    });
});

// challenge 5
Java.perform(() => {
    var MainActivity = Java.use("uk.rossmarks.fridalab.MainActivity");

    MainActivity.chall05.implementation = function (str) {
        return this.chall05("frida");
    };
});

// challenge 6
Java.perform(() => {
    setTimeout(function () {
        const Challenge06 = Java.use("uk.rossmarks.fridalab.challenge_06");
        Java.choose("uk.rossmarks.fridalab.MainActivity", {
            onMatch(instance) {
                const value = Challenge06.chall06.value;
                instance.chall06(value);
            },
            onComplete() {}
        });
    }, 11000);
});

// challenge 7
Java.perform(() => {
    setTimeout(() => {
        Java.choose("uk.rossmarks.fridalab.MainActivity", {
            onMatch(instance) {

                for (let i = 0; i &#x3C;= 9999; i++) {
                    const pin = ("0000" + i).slice(-4);

                    instance.chall07(pin);

                    if (instance.completeArr.value[6] === 1) {
                        console.log("[?????? ???] =", pin);
                        break;
                    }
                }

            },
            onComplete() {}
        });
    }, 1000);
});

// challenge 8
Java.perform(() => {
    const Button = Java.use("android.widget.Button");
    const JString = Java.use("java.lang.String");
    const checkId = Java.use("uk.rossmarks.fridalab.R$id").check.value;

    Java.choose("uk.rossmarks.fridalab.MainActivity", {
        onMatch(instance) {
            const view = instance.findViewById(checkId);
            if (!view) return;

            const btn = Java.cast(view, Button);
            btn.setText(JString.$new("Confirm"));
        },
        onComplete() {}
    });
});

</code></pre>
<h3>frida labs 풀이</h3>
<h3>1️⃣ com.ad2001.frida0x1`</h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/1번.js</code></p>
</li>
<li>
<p>설명
<code>MainActivity.get_random()</code> 메서드를 후킹하여
랜덤 값을 고정하거나 직접 제어해 조건을 만족시킴.</p>
<pre><code>Java.perform(() => {
var MainActivity = Java.use("com.ad2001.frida0x1.MainActivity");
MainActivity["get_random"].implementation = function () {
    console.log(`MainActivity.get_random is called`);
    let result = this["get_random"]();
    console.log(`MainActivity.get_random result=${result}`);
    return result;
};
});
</code></pre>
</li>
</ul>
<hr>
<h3>2️⃣ <code>com.ad2001.frida0x2</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/2번.js</code></p>
</li>
<li>
<p>설명
<code>MainActivity.get_flag(4919)</code> 메서드를 직접 호출하여
조건 검증을 우회하고 FLAG 획득.</p>
<pre><code>Java.perform(function () {
    var Main = Java.use('com.ad2001.frida0x2.MainActivity');
    Main.get_flag(4919);
});
</code></pre>
</li>
</ul>
<hr>
<h3>3️⃣ <code>com.ad2001.frida0x3</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/3번.js</code></p>
</li>
<li>
<p>설명
<code>Checker.code</code> 정적 필드를 <strong>512로 강제 설정</strong>하여
버튼 클릭 시 <code>YOU WON!!!</code> 조건을 만족하도록 조작.</p>
<pre><code>Java.perform(function () {
    var Checker = Java.use("com.ad2001.frida0x3.Checker");
    Checker.code.value = 512;
});
</code></pre>
</li>
</ul>
<hr>
<h3>4️⃣ <code>com.ad2001.frida0x4</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/4번.js</code></p>
</li>
<li>
<p>설명
<code>Check</code> 클래스의 인스턴스를 Frida로 생성한 뒤
<code>get_flag(1337)</code>을 직접 호출하여 XOR 기반 복호화 결과 획득.</p>
<pre><code>Java.perform(function () {
    var Check = Java.use("com.ad2001.frida0x4.Check");

    var obj = Check.$new();
    var result = obj.get_flag(1337);

    console.log("플레그 =", result);
});
</code></pre>
</li>
</ul>
<hr>
<h3>5️⃣ <code>com.ad2001.frida0x5</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/5번.js</code></p>
</li>
<li>
<p>설명
현재 실행 중인 <code>MainActivity</code> 인스턴스를 탐색한 후
<code>flag(1337)</code> 메서드를 호출하여 AES 복호화된 FLAG 출력.</p>
<pre><code>Java.perform(function () {
    Java.choose("com.ad2001.frida0x5.MainActivity", {
        onMatch: function (obj) {
            obj.flag(1337);
        },
        onComplete: function () {
        }
    });
});
</code></pre>
</li>
</ul>
<hr>
<h3>6️⃣ <code>com.ad2001.frida0x6</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/6번.js</code></p>
</li>
<li>
<p>설명
<code>Checker</code> 객체를 Frida에서 직접 생성하여</p>
<ul>
<li>
<p><code>num1 = 1234</code></p>
</li>
<li>
<p><code>num2 = 4321</code>
로 세팅한 뒤 <code>MainActivity.get_flag(obj)</code> 호출로 조건 통과.</p>
<pre><code>Java.perform(function () {
    Java.choose("com.ad2001.frida0x6.MainActivity", {
        onMatch: function (activity) {
            var Checker = Java.use("com.ad2001.frida0x6.Checker");
            var obj = Checker.$new();
            obj.num1.value = 1234;
            obj.num2.value = 4321;
            activity.get_flag(obj);
        },
        onComplete: function () {
        }
    });
});
</code></pre>
</li>
</ul>
</li>
</ul>
<hr>
<h3>7️⃣ <code>com.ad2001.frida0x7</code></h3>
<ul>
<li>
<p>스크립트: <code>fridalabs/7번.js</code></p>
</li>
<li>
<p>설명
<code>Checker</code> 생성자(오버로드)를 후킹하여
전달되는 인자 값을 강제로 <strong>513 이상</strong>으로 변경함으로써
조건문(<code>num1 > 512 &#x26;&#x26; num2 > 512</code>)을 항상 만족시키도록 우회.</p>
<pre><code>Java.perform(function () {
    var Checker = Java.use("com.ad2001.frida0x7.Checker");
    Checker.$init.overload('int', 'int').implementation = function (a, b) {
        return this.$init(513, 513);
    };
});
</code></pre>
</li>
</ul>
</div></article></main></div><script src="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/fff7d7d50ba66cff.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n6:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[8383,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"185\",\"static/chunks/app/layout-ada0ccfdc2732042.js\"],\"\"]\nc:I[8955,[],\"\"]\n7:[\"category\",\"Android\",\"d\"]\n8:[\"slug\",\"day12\",\"d\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fff7d7d50ba66cff.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"Abs63gimMocH9GC6KfM8u\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/Android/day12\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day12\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"Android\\\",\\\"slug\\\":\\\"day12\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day12\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n              (function() {\\n                try {\\n                  const savedTheme = localStorage.getItem('theme');\\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\\n                  const theme = savedTheme || 'dark';\\n                  document.documentElement.setAttribute('data-theme', theme);\\n                } catch (e) {}\\n              })();\\n            \"}}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"app-container\",\"children\":[[\"$\",\"$La\",null,{\"categories\":[\"AWS\",\"Android\",\"JAVA\"]}],[\"$\",\"main\",null,{\"className\":\"main-content\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}]}]]}],null]],\"initialHead\":[false,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]]\n"])</script><script>self.__next_f.push([1,"e:T2ddc,"])</script><script>self.__next_f.push([1,"\u003cp\u003eFrida Labs 직접 실습\u003c/p\u003e\n\u003ch2\u003eChallenge 풀이 요약\u003c/h2\u003e\n\u003ch3\u003e1️⃣ chall01\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e대상 클래스: \u003ccode\u003echallenge_01.chall01\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e내부 필드 값을 직접 수정하여 \u003cstrong\u003e값을 1로 설정\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e함수 호출 없이 필드 조작만으로 해결\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    var chall01 = Java.use(\"uk.rossmarks.fridalab.challenge_01\");\r\n    chall01.chall01.value = 1;\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e2️⃣ chall02\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMainActivity\u003c/code\u003e 인스턴스를 찾아\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003echall02()\u003c/code\u003e 메서드를 \u003cstrong\u003e직접 호출\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e파라미터 없이 호출 시 자동으로 완료\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch: function (instance) {\r\n            instance.chall02();\r\n        },\r\n        onComplete: function () { }\r\n    });\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e3️⃣ chall03\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e대상 메서드: \u003ccode\u003eMainActivity.chall03()\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e반환값을 항상 \u003ccode\u003etrue\u003c/code\u003e로 \u003cstrong\u003e후킹하여 고정\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e로직 무시 방식\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n   var MainActivity = Java.use(\"uk.rossmarks.fridalab.MainActivity\");\r\n    MainActivity.chall03.implementation = function () {\r\n        return true;\r\n};\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e4️⃣ chall04\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMainActivity.chall04(\"frida\")\u003c/code\u003e 호출\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e문자열 비교 로직을 만족하도록 \u003cstrong\u003e입력값 조작\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e인자 값 \u003ccode\u003e\"frida\"\u003c/code\u003e 전달로 해결\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch(instance) {\r\n            instance.chall04(\"frida\");\r\n        },\r\n        onComplete() {}\r\n    });\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e5️⃣ chall05\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eMainActivity.chall05\u003c/code\u003e 메서드 후킹\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e어떤 입력이 오더라도 내부에서 \u003ccode\u003e\"frida\"\u003c/code\u003e로 치환\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e입력 무력화 방식\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    var MainActivity = Java.use(\"uk.rossmarks.fridalab.MainActivity\");\r\n\r\n    MainActivity.chall05.implementation = function (str) {\r\n        return this.chall05(\"frida\");\r\n    };\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e6️⃣ chall06\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e앱 실행 후 \u003cstrong\u003e10초 대기 (총 11초 이상)\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003echallenge_06.chall06\u003c/code\u003e 내부 값 읽기\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e해당 값을 \u003ccode\u003eMainActivity.chall06(value)\u003c/code\u003e로 전달\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e타이밍 + 값 추출\u003c/strong\u003e 조합 문제\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    setTimeout(function () {\r\n        const Challenge06 = Java.use(\"uk.rossmarks.fridalab.challenge_06\");\r\n        Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n            onMatch(instance) {\r\n                const value = Challenge06.chall06.value;\r\n                instance.chall06(value);\r\n            },\r\n            onComplete() {}\r\n        });\r\n    }, 11000);\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e7️⃣ chall07\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ePIN 코드 \u003cstrong\u003e0000 ~ 9999 전체 브루트포스\u003c/strong\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003echall07(pin)\u003c/code\u003e 반복 호출\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e성공 조건:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecompleteArr[6] === 1\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e자동화 스크립트로 해결\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    setTimeout(() =\u003e {\r\n        Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n            onMatch(instance) {\r\n\r\n                for (let i = 0; i \u0026#x3C;= 9999; i++) {\r\n                    const pin = (\"0000\" + i).slice(-4);\r\n\r\n                    instance.chall07(pin);\r\n\r\n                    if (instance.completeArr.value[6] === 1) {\r\n                        console.log(\"[비밀번호 확인] =\", pin);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n            },\r\n            onComplete() {}\r\n        });\r\n    }, 1000);\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e8️⃣ chall08\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e버튼 ID: \u003ccode\u003echeck\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e버튼 텍스트를 \u003ccode\u003e\"Confirm\"\u003c/code\u003e으로 변경\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e이후 \u003ccode\u003echall08()\u003c/code\u003e 메서드 호출\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eUI 조작 + 함수 호출\u003c/strong\u003e 문제\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\n    const Button = Java.use(\"android.widget.Button\");\r\n    const JString = Java.use(\"java.lang.String\");\r\n    const checkId = Java.use(\"uk.rossmarks.fridalab.R$id\").check.value;\r\n\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch(instance) {\r\n            const view = instance.findViewById(checkId);\r\n            if (!view) return;\r\n\r\n            const btn = Java.cast(view, Button);\r\n            btn.setText(JString.$new(\"Confirm\"));\r\n        },\r\n        onComplete() {}\r\n    });\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e9️⃣ 전체 합친 코드\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e// challenge 1\r\nJava.perform(() =\u003e {\r\n    var chall01 = Java.use(\"uk.rossmarks.fridalab.challenge_01\");\r\n    chall01.chall01.value = 1;\r\n});\r\n\r\n// challenge 2\r\nJava.perform(function () {\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch: function (instance) {\r\n            instance.chall02();\r\n        },\r\n        onComplete: function () { }\r\n    });\r\n});\r\n\r\n// challenge 3\r\nJava.perform(() =\u003e {\r\n   var MainActivity = Java.use(\"uk.rossmarks.fridalab.MainActivity\");\r\n    MainActivity.chall03.implementation = function () {\r\n        return true;\r\n};\r\n});\r\n\r\n// challenge 4\r\nJava.perform(() =\u003e {\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch(instance) {\r\n            instance.chall04(\"frida\");\r\n        },\r\n        onComplete() {}\r\n    });\r\n});\r\n\r\n// challenge 5\r\nJava.perform(() =\u003e {\r\n    var MainActivity = Java.use(\"uk.rossmarks.fridalab.MainActivity\");\r\n\r\n    MainActivity.chall05.implementation = function (str) {\r\n        return this.chall05(\"frida\");\r\n    };\r\n});\r\n\r\n// challenge 6\r\nJava.perform(() =\u003e {\r\n    setTimeout(function () {\r\n        const Challenge06 = Java.use(\"uk.rossmarks.fridalab.challenge_06\");\r\n        Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n            onMatch(instance) {\r\n                const value = Challenge06.chall06.value;\r\n                instance.chall06(value);\r\n            },\r\n            onComplete() {}\r\n        });\r\n    }, 11000);\r\n});\r\n\r\n// challenge 7\r\nJava.perform(() =\u003e {\r\n    setTimeout(() =\u003e {\r\n        Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n            onMatch(instance) {\r\n\r\n                for (let i = 0; i \u0026#x3C;= 9999; i++) {\r\n                    const pin = (\"0000\" + i).slice(-4);\r\n\r\n                    instance.chall07(pin);\r\n\r\n                    if (instance.completeArr.value[6] === 1) {\r\n                        console.log(\"[?????? ???] =\", pin);\r\n                        break;\r\n                    }\r\n                }\r\n\r\n            },\r\n            onComplete() {}\r\n        });\r\n    }, 1000);\r\n});\r\n\r\n// challenge 8\r\nJava.perform(() =\u003e {\r\n    const Button = Java.use(\"android.widget.Button\");\r\n    const JString = Java.use(\"java.lang.String\");\r\n    const checkId = Java.use(\"uk.rossmarks.fridalab.R$id\").check.value;\r\n\r\n    Java.choose(\"uk.rossmarks.fridalab.MainActivity\", {\r\n        onMatch(instance) {\r\n            const view = instance.findViewById(checkId);\r\n            if (!view) return;\r\n\r\n            const btn = Java.cast(view, Button);\r\n            btn.setText(JString.$new(\"Confirm\"));\r\n        },\r\n        onComplete() {}\r\n    });\r\n});\r\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003efrida labs 풀이\u003c/h3\u003e\n\u003ch3\u003e1️⃣ com.ad2001.frida0x1`\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/1번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eMainActivity.get_random()\u003c/code\u003e 메서드를 후킹하여\r\n랜덤 값을 고정하거나 직접 제어해 조건을 만족시킴.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(() =\u003e {\r\nvar MainActivity = Java.use(\"com.ad2001.frida0x1.MainActivity\");\r\nMainActivity[\"get_random\"].implementation = function () {\r\n    console.log(`MainActivity.get_random is called`);\r\n    let result = this[\"get_random\"]();\r\n    console.log(`MainActivity.get_random result=${result}`);\r\n    return result;\r\n};\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e2️⃣ \u003ccode\u003ecom.ad2001.frida0x2\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/2번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eMainActivity.get_flag(4919)\u003c/code\u003e 메서드를 직접 호출하여\r\n조건 검증을 우회하고 FLAG 획득.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    var Main = Java.use('com.ad2001.frida0x2.MainActivity');\r\n    Main.get_flag(4919);\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e3️⃣ \u003ccode\u003ecom.ad2001.frida0x3\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/3번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eChecker.code\u003c/code\u003e 정적 필드를 \u003cstrong\u003e512로 강제 설정\u003c/strong\u003e하여\r\n버튼 클릭 시 \u003ccode\u003eYOU WON!!!\u003c/code\u003e 조건을 만족하도록 조작.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    var Checker = Java.use(\"com.ad2001.frida0x3.Checker\");\r\n    Checker.code.value = 512;\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e4️⃣ \u003ccode\u003ecom.ad2001.frida0x4\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/4번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eCheck\u003c/code\u003e 클래스의 인스턴스를 Frida로 생성한 뒤\r\n\u003ccode\u003eget_flag(1337)\u003c/code\u003e을 직접 호출하여 XOR 기반 복호화 결과 획득.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    var Check = Java.use(\"com.ad2001.frida0x4.Check\");\r\n\r\n    var obj = Check.$new();\r\n    var result = obj.get_flag(1337);\r\n\r\n    console.log(\"플레그 =\", result);\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e5️⃣ \u003ccode\u003ecom.ad2001.frida0x5\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/5번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n현재 실행 중인 \u003ccode\u003eMainActivity\u003c/code\u003e 인스턴스를 탐색한 후\r\n\u003ccode\u003eflag(1337)\u003c/code\u003e 메서드를 호출하여 AES 복호화된 FLAG 출력.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    Java.choose(\"com.ad2001.frida0x5.MainActivity\", {\r\n        onMatch: function (obj) {\r\n            obj.flag(1337);\r\n        },\r\n        onComplete: function () {\r\n        }\r\n    });\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e6️⃣ \u003ccode\u003ecom.ad2001.frida0x6\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/6번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eChecker\u003c/code\u003e 객체를 Frida에서 직접 생성하여\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enum1 = 1234\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enum2 = 4321\u003c/code\u003e\r\n로 세팅한 뒤 \u003ccode\u003eMainActivity.get_flag(obj)\u003c/code\u003e 호출로 조건 통과.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    Java.choose(\"com.ad2001.frida0x6.MainActivity\", {\r\n        onMatch: function (activity) {\r\n            var Checker = Java.use(\"com.ad2001.frida0x6.Checker\");\r\n            var obj = Checker.$new();\r\n            obj.num1.value = 1234;\r\n            obj.num2.value = 4321;\r\n            activity.get_flag(obj);\r\n        },\r\n        onComplete: function () {\r\n        }\r\n    });\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e7️⃣ \u003ccode\u003ecom.ad2001.frida0x7\u003c/code\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e스크립트: \u003ccode\u003efridalabs/7번.js\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e설명\r\n\u003ccode\u003eChecker\u003c/code\u003e 생성자(오버로드)를 후킹하여\r\n전달되는 인자 값을 강제로 \u003cstrong\u003e513 이상\u003c/strong\u003e으로 변경함으로써\r\n조건문(\u003ccode\u003enum1 \u003e 512 \u0026#x26;\u0026#x26; num2 \u003e 512\u003c/code\u003e)을 항상 만족시키도록 우회.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eJava.perform(function () {\r\n    var Checker = Java.use(\"com.ad2001.frida0x7.Checker\");\r\n    Checker.$init.overload('int', 'int').implementation = function (a, b) {\r\n        return this.$init(513, 513);\r\n    };\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"className\":\"article-container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article-header\",\"children\":[[\"$\",\"span\",null,{\"className\":\"article-category\",\"children\":\"Android\"}],[\"$\",\"h1\",null,{\"className\":\"article-title\",\"children\":\"Android 보안 12일차\"}]]}],[\"$\",\"div\",null,{\"className\":\"article-content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$e\"}}]]}]\nb:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"titl"])</script><script>self.__next_f.push([1,"e\",\"2\",{\"children\":\"jinwk note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"jinwk dev note\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>