<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/profile_cute.png"/><link rel="stylesheet" href="/_next/static/css/fff7d7d50ba66cff.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-c50cb70e7323352b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-0c59dfdc78baeb85.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-baff347ce7e39457.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-069982e43c2ae463.js" async=""></script><script src="/_next/static/chunks/app/layout-10c7e025b6149e17.js" async=""></script><script src="/_next/static/chunks/app/page-e31ae51de7be232e.js" async=""></script><title>jinwk note</title><meta name="description" content="jinwk dev note"/><script>
              (function() {
                try {
                  const savedTheme = localStorage.getItem('theme');
                  // Default to 'dark' if no save found, ignoring system preference for now to start dark
                  const theme = savedTheme || 'dark';
                  document.documentElement.setAttribute('data-theme', theme);
                } catch (e) {}
              })();
            </script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div class="app-container"><aside class="sidebar"><div class="profile-section"><div class="profile-img-wrapper"><img src="/profile_cute.png" alt="Profile" class="profile-img"/></div><div class="profile-name" style="display:flex;align-items:center;justify-content:center;gap:0.5rem">jinwook yu<a style="font-size:0.9rem;opacity:0.5;text-decoration:none" href="/admin/">⚙️</a></div><div class="profile-subtitle" style="font-size:0.9rem;color:var(--text-muted);margin-bottom:1rem">dbwlsdnr95</div><div class="profile-bio" style="white-space:pre-line;font-size:0.85rem;text-align:left;width:100%">웹·모바일 진단 ,솔루션 운영 및 클라우드 보안을 경험했고, 현재는 모의해킹·취약점 분석·CVE 연구에 집중하고 있습니다. 실전 기반 보안 역량을 꾸준히 확장하고 있습니다.</div></div><nav class="nav-section"><div class="nav-title">분류 전체보기</div><ul class="nav-list" style="margin-bottom:2rem"><li class="nav-item"><a class="" href="/">전체보기</a></li></ul><div style="margin-bottom:2rem"><div class="nav-title">교육</div><ul class="nav-list"><li class="nav-item"><a class="" href="/category/Android/">Android</a></li><li class="nav-item"><a class="" href="/category/JAVA/">JAVA</a></li><li class="nav-item"><a class="" href="/category/AWS/">AWS</a></li></ul></div></nav></aside><main class="main-content"><article class="article-container"><div class="article-header"><span class="article-category">Android</span><h1 class="article-title">Android 보안 15일차</h1></div><div class="article-content"><h1>JNI + Frida Native 분석 정리</h1>
<h2>1. Native 라이브러리 메모리 구조</h2>
<h3>실행 시 메모리 배치 개념</h3>
<pre><code>testapp           libtestapp.so           libc.so
0x00000000        0x00123456              0x00234567
</code></pre>
<ul>
<li><strong>base address</strong>
<ul>
<li>앱 또는 라이브러리가 메모리에 적재된 시작 주소</li>
</ul>
</li>
<li><strong>offset</strong>
<ul>
<li>base 주소로부터 함수가 위치한 상대 거리</li>
</ul>
</li>
</ul>
<h3>주소 계산 공식</h3>
<pre><code>실제 함수 주소 = module.base + offset
</code></pre>
<p>예:</p>
<pre><code>base = 0x00100000
offset = 0x000245b0
실제 주소 = 0x001245b0
</code></pre>
<hr>
<h2>2. JNI 함수 예제 (checkPassword)</h2>
<h3>Java 선언부</h3>
<pre><code>public native boolean checkPassword(String pw);
</code></pre>
<h3>Native 함수 시그니처</h3>
<pre><code>Java_kr_seyong_testapp_MainActivity_checkPassword(
    JNIEnv* env,
    jobject thiz,
    jstring pw
)
</code></pre>
<hr>
<h2>3. Ghidra에서 본 Native 코드</h2>
<pre><code>bool Java_kr_seyong_testapp_MainActivity_checkPassword(
    _JNIEnv *env,
    undefined8 thiz,
    _jstring *pw
) {
    int ret;
    char* nativeStr;

    nativeStr = (char*)env->GetStringUTFChars(pw, 0);
    ret = strcmp(nativeStr, "hacker");
    env->ReleaseStringUTFChars(pw, nativeStr);

    return ret == 0;
}
</code></pre>
<h3>핵심 포인트</h3>
<ul>
<li><code>jstring → char*</code> 변환</li>
<li><code>strcmp()</code> 로 문자열 비교</li>
<li><code>"hacker"</code> 와 동일하면 true</li>
</ul>
<hr>
<h2>4. JNI 분석 순서 정리</h2>
<ol>
<li>Java에서 <strong>native 함수 선언부 확인</strong></li>
<li><code>System.loadLibrary()</code> 또는 <code>System.load()</code> 확인</li>
<li>실제 <code>.so</code> 파일 위치 확인
<ul>
<li><code>/lib/&#x3C;abi>/libxxx.so</code></li>
<li><code>/android/obb/</code></li>
</ul>
</li>
<li>현재 실행 환경에 맞는 ABI 선택</li>
<li><code>.so</code> 파일 추출</li>
<li>Ghidra로 열기</li>
<li>Export 함수 목록 확인</li>
<li>분석 대상 함수 확인</li>
</ol>
<hr>
<h2>5. Frida에서 Native 제어 개념</h2>
<h3>Java vs Native 제어 방식</h3>
<table>
<thead>
<tr>
<th>구분</th>
<th>Java</th>
<th>Native</th>
</tr>
</thead>
<tbody>
<tr>
<td>접근 방식</td>
<td>Java.use</td>
<td>NativePointer</td>
</tr>
<tr>
<td>기준</td>
<td>클래스/메소드</td>
<td>메모리 주소</td>
</tr>
<tr>
<td>후킹</td>
<td>implementation</td>
<td>Interceptor</td>
</tr>
</tbody>
</table>
<hr>
<h2>6. Native 함수 주소 찾기</h2>
<h3>Export 기반</h3>
<pre><code>var lib = Process.findModuleByName("libtestapp.so");
var func = lib.findExportByName(
  "Java_kr_seyong_testapp_MainActivity_checkPassword"
);
</code></pre>
<h3>Offset 기반</h3>
<pre><code>var base = lib.base;
var func = base.add(0x245b0);
</code></pre>
<hr>
<h2>7. Native 함수 후킹 (Interceptor.attach)</h2>
<pre><code>Interceptor.attach(func, {
    onEnter: function (args) {
        console.log("checkPassword 호출");

        // args[2] = jstring pw
    },
    onLeave: function (ret) {
        console.log("리턴값:", ret);
    }
});
</code></pre>
<h3>인자 구조</h3>
<pre><code>args[0] → JNIEnv*
args[1] → jobject (this)
args[2] → jstring pw
</code></pre>
<hr>
<h2>8. 인자 값 변조 (메모리 조작)</h2>
<pre><code>Interceptor.attach(func, {
    onEnter: function (args) {
        var newStr = Memory.allocUtf8String("hackernono");
        args[2] = newStr;
    }
});
</code></pre>
<ul>
<li>Native 영역은 <strong>메모리 직접 수정</strong></li>
<li>문자열 끝에 <code>\0</code> 필요</li>
</ul>
<hr>
<h2>9. 리턴값 변조</h2>
<pre><code>Interceptor.attach(func, {
    onLeave: function (ret) {
        ret.replace(0x01); // true
    }
});
</code></pre>
<ul>
<li>인증 로직 강제 통과 가능</li>
</ul>
<hr>
<h2>10. 함수 완전 교체 (Interceptor.replace)</h2>
<pre><code>var newFunc = new NativeCallback(function () {
    return 1;
}, 'int', []);

Interceptor.replace(func, newFunc);
</code></pre>
<ul>
<li>원래 함수 실행 자체를 제거</li>
</ul>
<hr>
<h2>11. Native 함수 직접 호출</h2>
<pre><code>var nativeFunc = new NativeFunction(
    func,
    'int',
    ['pointer', 'pointer', 'pointer']
);

var result = nativeFunc(a, b, c);
console.log(result);
</code></pre>
<hr>
<h2>12. strcmp 후킹 개념</h2>
<pre><code>var strcmpPtr = ptr("0x79cbc06e4010");
</code></pre>
<p>주의:</p>
<ul>
<li>문자열 <code>"0x79cbc06e4010"</code> → 잘못된 타입</li>
<li>반드시 <code>ptr()</code> 또는 <code>NativePointer</code> 사용</li>
</ul>
<hr>
<h2>13. 모듈 / 함수 탐색</h2>
<pre><code>Process.enumerateModules();
Module.enumerateExports();
Module.enumerateImports();
</code></pre>
<hr>
<h2>14. JNI 문자열 처리 예제 (정상 구현)</h2>
<pre><code>const char* jstringToCString(JNIEnv* env, jstring jstr) {
    if (jstr == NULL) return NULL;
    return env->GetStringUTFChars(jstr, NULL);
}
jboolean checkPasswordNative(const char* pw) {
    if (pw == NULL) return JNI_FALSE;
    return strcmp(pw, "hacker") == 0;
}
</code></pre>
<hr>
<h2>15. Frida 개발 환경 팁</h2>
<ul>
<li>Frida JS 자동완성
<ul>
<li>Node.js 설치 필요</li>
</ul>
</li>
<li>VSCode
<ul>
<li>Extension: <strong>Frida Workbench</strong></li>
<li>명령 팔레트 → <code>Frida: Enable Hints</code></li>
</ul>
</li>
</ul>
<hr>
<h2>16. 핵심 정리</h2>
<ul>
<li>JNI 분석은 <strong>주소 기반 사고</strong></li>
<li>offset 개념 필수</li>
<li>Java 문자열 ≠ C 문자열</li>
<li>Native 후킹은 <code>Interceptor</code></li>
<li>인증/무결성 로직은 Native에 숨겨지는 경우가 많음</li>
<li>Ghidra + Frida 조합이 가장 강력</li>
</ul>
</div></article></main></div><script src="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/fff7d7d50ba66cff.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n6:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[8383,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"185\",\"static/chunks/app/layout-10c7e025b6149e17.js\"],\"\"]\nb:I[5250,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"931\",\"static/chunks/app/page-e31ae51de7be232e.js\"],\"\"]\nd:I[8955,[],\"\"]\n7:[\"category\",\"Android\",\"d\"]\n8:[\"slug\",\"day15\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fff7d7d50ba66cff.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"2BDZlJ6cDPI6q5M9NRLC3\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/Android/day15/\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day15\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"Android\\\",\\\"slug\\\":\\\"day15\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day15\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n              (function() {\\n                try {\\n                  const savedTheme = localStorage.getItem('theme');\\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\\n                  const theme = savedTheme || 'dark';\\n                  document.documentElement.setAttribute('data-theme', theme);\\n                } catch (e) {}\\n              })();\\n            \"}}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"app-container\",\"children\":[[\"$\",\"$La\",null,{\"categories\":[\"AWS\",\"Android\",\"JAVA\"]}],[\"$\",\"main\",null,{\"className\":\"main-content\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center min-h-[60vh] text-center px-4\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-4xl font-bold mb-4\",\"children\":\"404 - Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-500 mb-8\",\"children\":\"요청하신 페이지를 찾을 수 없습니다.\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"className\":\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition\",\"children\":\"홈으로 돌아가기\"}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}]}]]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"f:T16e0,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eJNI + Frida Native 분석 정리\u003c/h1\u003e\n\u003ch2\u003e1. Native 라이브러리 메모리 구조\u003c/h2\u003e\n\u003ch3\u003e실행 시 메모리 배치 개념\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003etestapp           libtestapp.so           libc.so\r\n0x00000000        0x00123456              0x00234567\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003ebase address\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e앱 또는 라이브러리가 메모리에 적재된 시작 주소\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eoffset\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003ebase 주소로부터 함수가 위치한 상대 거리\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e주소 계산 공식\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e실제 함수 주소 = module.base + offset\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e예:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ebase = 0x00100000\r\noffset = 0x000245b0\r\n실제 주소 = 0x001245b0\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e2. JNI 함수 예제 (checkPassword)\u003c/h2\u003e\n\u003ch3\u003eJava 선언부\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003epublic native boolean checkPassword(String pw);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eNative 함수 시그니처\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eJava_kr_seyong_testapp_MainActivity_checkPassword(\r\n    JNIEnv* env,\r\n    jobject thiz,\r\n    jstring pw\r\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e3. Ghidra에서 본 Native 코드\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003ebool Java_kr_seyong_testapp_MainActivity_checkPassword(\r\n    _JNIEnv *env,\r\n    undefined8 thiz,\r\n    _jstring *pw\r\n) {\r\n    int ret;\r\n    char* nativeStr;\r\n\r\n    nativeStr = (char*)env-\u003eGetStringUTFChars(pw, 0);\r\n    ret = strcmp(nativeStr, \"hacker\");\r\n    env-\u003eReleaseStringUTFChars(pw, nativeStr);\r\n\r\n    return ret == 0;\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e핵심 포인트\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ejstring → char*\u003c/code\u003e 변환\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estrcmp()\u003c/code\u003e 로 문자열 비교\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\"hacker\"\u003c/code\u003e 와 동일하면 true\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e4. JNI 분석 순서 정리\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eJava에서 \u003cstrong\u003enative 함수 선언부 확인\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSystem.loadLibrary()\u003c/code\u003e 또는 \u003ccode\u003eSystem.load()\u003c/code\u003e 확인\u003c/li\u003e\n\u003cli\u003e실제 \u003ccode\u003e.so\u003c/code\u003e 파일 위치 확인\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e/lib/\u0026#x3C;abi\u003e/libxxx.so\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e/android/obb/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e현재 실행 환경에 맞는 ABI 선택\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.so\u003c/code\u003e 파일 추출\u003c/li\u003e\n\u003cli\u003eGhidra로 열기\u003c/li\u003e\n\u003cli\u003eExport 함수 목록 확인\u003c/li\u003e\n\u003cli\u003e분석 대상 함수 확인\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2\u003e5. Frida에서 Native 제어 개념\u003c/h2\u003e\n\u003ch3\u003eJava vs Native 제어 방식\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e구분\u003c/th\u003e\n\u003cth\u003eJava\u003c/th\u003e\n\u003cth\u003eNative\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e접근 방식\u003c/td\u003e\n\u003ctd\u003eJava.use\u003c/td\u003e\n\u003ctd\u003eNativePointer\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e기준\u003c/td\u003e\n\u003ctd\u003e클래스/메소드\u003c/td\u003e\n\u003ctd\u003e메모리 주소\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e후킹\u003c/td\u003e\n\u003ctd\u003eimplementation\u003c/td\u003e\n\u003ctd\u003eInterceptor\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003chr\u003e\n\u003ch2\u003e6. Native 함수 주소 찾기\u003c/h2\u003e\n\u003ch3\u003eExport 기반\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003evar lib = Process.findModuleByName(\"libtestapp.so\");\r\nvar func = lib.findExportByName(\r\n  \"Java_kr_seyong_testapp_MainActivity_checkPassword\"\r\n);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eOffset 기반\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003evar base = lib.base;\r\nvar func = base.add(0x245b0);\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e7. Native 함수 후킹 (Interceptor.attach)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eInterceptor.attach(func, {\r\n    onEnter: function (args) {\r\n        console.log(\"checkPassword 호출\");\r\n\r\n        // args[2] = jstring pw\r\n    },\r\n    onLeave: function (ret) {\r\n        console.log(\"리턴값:\", ret);\r\n    }\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e인자 구조\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eargs[0] → JNIEnv*\r\nargs[1] → jobject (this)\r\nargs[2] → jstring pw\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e8. 인자 값 변조 (메모리 조작)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eInterceptor.attach(func, {\r\n    onEnter: function (args) {\r\n        var newStr = Memory.allocUtf8String(\"hackernono\");\r\n        args[2] = newStr;\r\n    }\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eNative 영역은 \u003cstrong\u003e메모리 직접 수정\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e문자열 끝에 \u003ccode\u003e\\0\u003c/code\u003e 필요\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e9. 리턴값 변조\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eInterceptor.attach(func, {\r\n    onLeave: function (ret) {\r\n        ret.replace(0x01); // true\r\n    }\r\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e인증 로직 강제 통과 가능\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e10. 함수 완전 교체 (Interceptor.replace)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003evar newFunc = new NativeCallback(function () {\r\n    return 1;\r\n}, 'int', []);\r\n\r\nInterceptor.replace(func, newFunc);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e원래 함수 실행 자체를 제거\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e11. Native 함수 직접 호출\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003evar nativeFunc = new NativeFunction(\r\n    func,\r\n    'int',\r\n    ['pointer', 'pointer', 'pointer']\r\n);\r\n\r\nvar result = nativeFunc(a, b, c);\r\nconsole.log(result);\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e12. strcmp 후킹 개념\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003evar strcmpPtr = ptr(\"0x79cbc06e4010\");\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e주의:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e문자열 \u003ccode\u003e\"0x79cbc06e4010\"\u003c/code\u003e → 잘못된 타입\u003c/li\u003e\n\u003cli\u003e반드시 \u003ccode\u003eptr()\u003c/code\u003e 또는 \u003ccode\u003eNativePointer\u003c/code\u003e 사용\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e13. 모듈 / 함수 탐색\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eProcess.enumerateModules();\r\nModule.enumerateExports();\r\nModule.enumerateImports();\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e14. JNI 문자열 처리 예제 (정상 구현)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003econst char* jstringToCString(JNIEnv* env, jstring jstr) {\r\n    if (jstr == NULL) return NULL;\r\n    return env-\u003eGetStringUTFChars(jstr, NULL);\r\n}\r\njboolean checkPasswordNative(const char* pw) {\r\n    if (pw == NULL) return JNI_FALSE;\r\n    return strcmp(pw, \"hacker\") == 0;\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e15. Frida 개발 환경 팁\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFrida JS 자동완성\n\u003cul\u003e\n\u003cli\u003eNode.js 설치 필요\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eVSCode\n\u003cul\u003e\n\u003cli\u003eExtension: \u003cstrong\u003eFrida Workbench\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e명령 팔레트 → \u003ccode\u003eFrida: Enable Hints\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e16. 핵심 정리\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eJNI 분석은 \u003cstrong\u003e주소 기반 사고\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eoffset 개념 필수\u003c/li\u003e\n\u003cli\u003eJava 문자열 ≠ C 문자열\u003c/li\u003e\n\u003cli\u003eNative 후킹은 \u003ccode\u003eInterceptor\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e인증/무결성 로직은 Native에 숨겨지는 경우가 많음\u003c/li\u003e\n\u003cli\u003eGhidra + Frida 조합이 가장 강력\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"className\":\"article-container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article-header\",\"children\":[[\"$\",\"span\",null,{\"className\":\"article-category\",\"children\":\"Android\"}],[\"$\",\"h1\",null,{\"className\":\"article-title\",\"children\":\"Android 보안 15일차\"}]]}],[\"$\",\"div\",null,{\"className\":\"article-content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$f\"}}]]}]\nc:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"titl"])</script><script>self.__next_f.push([1,"e\",\"2\",{\"children\":\"jinwk note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"jinwk dev note\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>