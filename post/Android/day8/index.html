<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/profile_cute.png"/><link rel="stylesheet" href="/_next/static/css/fff7d7d50ba66cff.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-c50cb70e7323352b.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-0c59dfdc78baeb85.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-baff347ce7e39457.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-069982e43c2ae463.js" async=""></script><script src="/_next/static/chunks/app/layout-10c7e025b6149e17.js" async=""></script><script src="/_next/static/chunks/app/page-e31ae51de7be232e.js" async=""></script><title>jinwk note</title><meta name="description" content="jinwk dev note"/><script>
              (function() {
                try {
                  const savedTheme = localStorage.getItem('theme');
                  // Default to 'dark' if no save found, ignoring system preference for now to start dark
                  const theme = savedTheme || 'dark';
                  document.documentElement.setAttribute('data-theme', theme);
                } catch (e) {}
              })();
            </script><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div class="app-container"><aside class="sidebar"><div class="profile-section"><div class="profile-img-wrapper"><img src="/profile_cute.png" alt="Profile" class="profile-img"/></div><div class="profile-name" style="display:flex;align-items:center;justify-content:center;gap:0.5rem">jinwook yu<a style="font-size:0.9rem;opacity:0.5;text-decoration:none" href="/admin/">⚙️</a></div><div class="profile-subtitle" style="font-size:0.9rem;color:var(--text-muted);margin-bottom:1rem">dbwlsdnr95</div><div class="profile-bio" style="white-space:pre-line;font-size:0.85rem;text-align:left;width:100%">웹·모바일 진단 ,솔루션 운영 및 클라우드 보안을 경험했고, 현재는 모의해킹·취약점 분석·CVE 연구에 집중하고 있습니다. 실전 기반 보안 역량을 꾸준히 확장하고 있습니다.</div></div><nav class="nav-section"><div class="nav-title">분류 전체보기</div><ul class="nav-list" style="margin-bottom:2rem"><li class="nav-item"><a class="" href="/">전체보기</a></li></ul><div style="margin-bottom:2rem"><div class="nav-title">교육</div><ul class="nav-list"><li class="nav-item"><a class="" href="/category/Android/">Android</a></li><li class="nav-item"><a class="" href="/category/JAVA/">JAVA</a></li><li class="nav-item"><a class="" href="/category/AWS/">AWS</a></li></ul></div></nav></aside><main class="main-content"><article class="article-container"><div class="article-header"><span class="article-category">Android</span><h1 class="article-title">Android 보안 8일차</h1></div><div class="article-content"><h1>정적 분석 정리 (Crypto · Smali · APK 변조)</h1>
<hr>
<h2>정적분석 4번 — AES/CBC 기반 암호화 구조 분석</h2>
<h3>1. 암호화 로직 구조</h3>
<ul>
<li>암호화 알고리즘
<ul>
<li><code>AES/CBC/PKCS5Padding</code></li>
</ul>
</li>
<li>암호화 키
<ul>
<li>문자열: <code>0123456789abcdef</code></li>
<li>바이트 배열 변환 → <code>bArr</code></li>
</ul>
</li>
<li>IV (Initialization Vector)
<ul>
<li><code>bArr2</code></li>
<li>16바이트 랜덤 값</li>
</ul>
</li>
<li>평문 암호화
<ul>
<li><code>bArrDoFinal = AES.encrypt(plaintext, key=bArr, iv=bArr2)</code></li>
</ul>
</li>
</ul>
<hr>
<h3>2. 최종 암호문 포맷</h3>
<pre><code>Base64( IV(16바이트) + CipherText )
</code></pre>
<ul>
<li><code>strEncodeToString</code>
→ <code>bArr2 + bArrDoFinal</code>을 Base64 인코딩한 문자열</li>
</ul>
<hr>
<h3>3. 복호화 절차</h3>
<ol>
<li>Base64 디코딩</li>
<li>앞 16바이트 분리 → IV</li>
<li>나머지 바이트 → 암호문</li>
<li>AES/CBC/PKCS5Padding 복호화</li>
<li>원문 획득</li>
</ol>
<hr>
<h3>4. 실제 분석 데이터</h3>
<h4>저장 위치</h4>
<pre><code>/data/data/패키지명/shared_prefs/app_prefs.xml
</code></pre>
<h4>암호화된 플래그</h4>
<pre><code>iDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY
</code></pre>
<hr>
<h3>5. Base64 디코딩 결과 (Hex)</h3>
<pre><code>88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d
a7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33
12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98
</code></pre>
<ul>
<li>IV (16바이트)</li>
</ul>
<pre><code>88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d
</code></pre>
<ul>
<li>암호문</li>
</ul>
<pre><code>a7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33
12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98
</code></pre>
<hr>
<h3>6. 복호화 정보 요약</h3>
<p>| 항목     | 값                   |
| -------- | -------------------- |
| 알고리즘 | AES/CBC/PKCS5Padding |
| 키       | 0123456789abcdef     |
| IV       | 앞 16바이트          |
| 암호문   | 나머지 바이트        |
| 결과     | 평문 플래그          |</p>
<hr>
<h2>정적분석 5번 — AES/GCM + PBKDF2 구조 분석</h2>
<hr>
<h3>1. 암호화 흐름</h3>
<pre><code>encrypt(평문)
 → encrypt(평문, "eqst_lms")
</code></pre>
<hr>
<h3>2. 난수 값 생성</h3>
<ul>
<li><code>bArr[16]</code>
<ul>
<li>16바이트 랜덤 Salt</li>
</ul>
</li>
<li><code>bArr2[12]</code>
<ul>
<li>12바이트 랜덤 IV</li>
</ul>
</li>
</ul>
<hr>
<h3>3. 키 파생 (Key Derivation)</h3>
<pre><code>PBEKeySpec("eqst_lms", salt, 150000, 256)
</code></pre>
<ul>
<li>알고리즘
<ul>
<li>PBKDF2WithHmacSHA256</li>
<li>(일부 구현에서는 PBKDF2WithHmacSHA1 사용)</li>
</ul>
</li>
</ul>
<hr>
<h3>4. 암호화 알고리즘</h3>
<ul>
<li><code>AES/GCM/NoPadding</code></li>
<li><code>GCMParameterSpec(128, bArr2)</code></li>
</ul>
<hr>
<h3>5. 최종 암호문 포맷</h3>
<pre><code>01 | Salt(16) | IV(12) | CipherText | GCM Tag
</code></pre>
<ul>
<li>전체를 Base64 인코딩하여 반환</li>
</ul>
<hr>
<h3>6. 암호문 예시</h3>
<pre><code>AZ/oUGgQWbCw9isMhikWIkSrSfGQuG+YU82+0jgKjb0bGfwtRWmne9Wku1y7Tyg/c99gKAYGPuIAvTVfdg==
</code></pre>
<hr>
<h3>7. Base64 디코딩 결과 (Hex)</h3>
<pre><code>01
9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44
ab 49 f1 90 b8 6f 98 53 cd be d2 38
0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb
4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76
</code></pre>
<hr>
<h3>8. 데이터 분리</h3>
<ul>
<li>버전</li>
</ul>
<pre><code>01
</code></pre>
<ul>
<li>Salt (16바이트)</li>
</ul>
<pre><code>9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44
</code></pre>
<ul>
<li>IV (12바이트)</li>
</ul>
<pre><code>ab 49 f1 90 b8 6f 98 53 cd be d2 38
</code></pre>
<ul>
<li>암호문</li>
</ul>
<pre><code>0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb
</code></pre>
<ul>
<li>GCM Tag</li>
</ul>
<pre><code>4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76
</code></pre>
<hr>
<h2>Smali 코드 분석 및 APK 변조</h2>
<hr>
<h3>Smali 분석 특징</h3>
<ul>
<li>dex → smali 변조 가능</li>
<li>Java 코드 직접 변조는 불가</li>
<li>smali 수정 후 재빌드 필요</li>
</ul>
<hr>
<h3>APK 변조 흐름</h3>
<ol>
<li>APK 디컴파일</li>
<li>Java 코드 기준으로 로직 분석</li>
<li>대응되는 <code>.smali</code> 코드 탐색</li>
<li>smali 코드 직접 수정</li>
<li>재빌드 및 재서명</li>
<li>설치 후 실행</li>
</ol>
<hr>
<h3>Activity 실행</h3>
<pre><code>am start 액티비티이름
</code></pre>
<hr>
<h3>CPU ABI 확인</h3>
<pre><code>Build.CPU_ABI
</code></pre>
<ul>
<li>예: <code>arm64-v8a</code>, <code>x86_64</code></li>
</ul>
<hr>
<h3>Smali 조건 분기 정리</h3>
<pre><code>if-eq v0, v1      같으면 분기
if-neq v0, v1     다르면 분기
if-eqz v0         v0 == 0
if-nez v0         v0 != 0
if-lt v0, v1      v0 &#x3C; v1
if-le v0, v1      v0 &#x3C;= v1
if-gt v0, v1      v0 > v1
if-ge v0, v1      v0 >= v1
if-ltz v0         v0 &#x3C; 0
if-lez v0         v0 &#x3C;= 0
if-gtz v0         v0 > 0
if-gez v0         v0 >= 0
</code></pre>
<hr>
<h3>CRC 무결성 확인</h3>
<ul>
<li>원본 APK <code>classes.dex</code> CRC</li>
</ul>
<pre><code>1302005358
</code></pre>
<ul>
<li>변조된 APK <code>classes.dex</code> CRC</li>
</ul>
<pre><code>2993910671
</code></pre>
</div></article></main></div><script src="/_next/static/chunks/webpack-c5f8510880a90daa.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/fff7d7d50ba66cff.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n6:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[8383,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"185\",\"static/chunks/app/layout-10c7e025b6149e17.js\"],\"\"]\nb:I[5250,[\"250\",\"static/chunks/250-069982e43c2ae463.js\",\"931\",\"static/chunks/app/page-e31ae51de7be232e.js\"],\"\"]\nd:I[8955,[],\"\"]\n7:[\"category\",\"Android\",\"d\"]\n8:[\"slug\",\"day8\",\"d\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fff7d7d50ba66cff.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"16MaIM6sfU5RrcCsiLE0O\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/post/Android/day8/\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day8\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"Android\\\",\\\"slug\\\":\\\"day8\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day8\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n              (function() {\\n                try {\\n                  const savedTheme = localStorage.getItem('theme');\\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\\n                  const theme = savedTheme || 'dark';\\n                  document.documentElement.setAttribute('data-theme', theme);\\n                } catch (e) {}\\n              })();\\n            \"}}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"app-container\",\"children\":[[\"$\",\"$La\",null,{\"categories\":[\"AWS\",\"Android\",\"JAVA\"]}],[\"$\",\"main\",null,{\"className\":\"main-content\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center min-h-[60vh] text-center px-4\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-4xl font-bold mb-4\",\"children\":\"404 - Not Found\"}],[\"$\",\"p\",null,{\"className\":\"text-gray-500 mb-8\",\"children\":\"요청하신 페이지를 찾을 수 없습니다.\"}],[\"$\",\"$Lb\",null,{\"href\":\"/\",\"className\":\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition\",\"children\":\"홈으로 돌아가기\"}]]}],\"notFoundStyles\":[],\"styles\":null}]}]]}]}]]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"f:T14f0,"])</script><script>self.__next_f.push([1,"\u003ch1\u003e정적 분석 정리 (Crypto · Smali · APK 변조)\u003c/h1\u003e\n\u003chr\u003e\n\u003ch2\u003e정적분석 4번 — AES/CBC 기반 암호화 구조 분석\u003c/h2\u003e\n\u003ch3\u003e1. 암호화 로직 구조\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e암호화 알고리즘\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eAES/CBC/PKCS5Padding\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e암호화 키\n\u003cul\u003e\n\u003cli\u003e문자열: \u003ccode\u003e0123456789abcdef\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e바이트 배열 변환 → \u003ccode\u003ebArr\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eIV (Initialization Vector)\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebArr2\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e16바이트 랜덤 값\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e평문 암호화\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebArrDoFinal = AES.encrypt(plaintext, key=bArr, iv=bArr2)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e2. 최종 암호문 포맷\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eBase64( IV(16바이트) + CipherText )\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003estrEncodeToString\u003c/code\u003e\r\n→ \u003ccode\u003ebArr2 + bArrDoFinal\u003c/code\u003e을 Base64 인코딩한 문자열\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e3. 복호화 절차\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eBase64 디코딩\u003c/li\u003e\n\u003cli\u003e앞 16바이트 분리 → IV\u003c/li\u003e\n\u003cli\u003e나머지 바이트 → 암호문\u003c/li\u003e\n\u003cli\u003eAES/CBC/PKCS5Padding 복호화\u003c/li\u003e\n\u003cli\u003e원문 획득\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3\u003e4. 실제 분석 데이터\u003c/h3\u003e\n\u003ch4\u003e저장 위치\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003e/data/data/패키지명/shared_prefs/app_prefs.xml\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003e암호화된 플래그\u003c/h4\u003e\n\u003cpre\u003e\u003ccode\u003eiDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e5. Base64 디코딩 결과 (Hex)\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d\r\na7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33\r\n12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eIV (16바이트)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e암호문\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003ea7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33\r\n12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e6. 복호화 정보 요약\u003c/h3\u003e\n\u003cp\u003e| 항목     | 값                   |\r\n| -------- | -------------------- |\r\n| 알고리즘 | AES/CBC/PKCS5Padding |\r\n| 키       | 0123456789abcdef     |\r\n| IV       | 앞 16바이트          |\r\n| 암호문   | 나머지 바이트        |\r\n| 결과     | 평문 플래그          |\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003e정적분석 5번 — AES/GCM + PBKDF2 구조 분석\u003c/h2\u003e\n\u003chr\u003e\n\u003ch3\u003e1. 암호화 흐름\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eencrypt(평문)\r\n → encrypt(평문, \"eqst_lms\")\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e2. 난수 값 생성\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ebArr[16]\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e16바이트 랜덤 Salt\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ebArr2[12]\u003c/code\u003e\n\u003cul\u003e\n\u003cli\u003e12바이트 랜덤 IV\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e3. 키 파생 (Key Derivation)\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003ePBEKeySpec(\"eqst_lms\", salt, 150000, 256)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e알고리즘\n\u003cul\u003e\n\u003cli\u003ePBKDF2WithHmacSHA256\u003c/li\u003e\n\u003cli\u003e(일부 구현에서는 PBKDF2WithHmacSHA1 사용)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e4. 암호화 알고리즘\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eAES/GCM/NoPadding\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGCMParameterSpec(128, bArr2)\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e5. 최종 암호문 포맷\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e01 | Salt(16) | IV(12) | CipherText | GCM Tag\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e전체를 Base64 인코딩하여 반환\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e6. 암호문 예시\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eAZ/oUGgQWbCw9isMhikWIkSrSfGQuG+YU82+0jgKjb0bGfwtRWmne9Wku1y7Tyg/c99gKAYGPuIAvTVfdg==\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e7. Base64 디코딩 결과 (Hex)\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e01\r\n9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44\r\nab 49 f1 90 b8 6f 98 53 cd be d2 38\r\n0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb\r\n4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e8. 데이터 분리\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e버전\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e01\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eSalt (16바이트)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eIV (12바이트)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003eab 49 f1 90 b8 6f 98 53 cd be d2 38\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e암호문\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eGCM Tag\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003eSmali 코드 분석 및 APK 변조\u003c/h2\u003e\n\u003chr\u003e\n\u003ch3\u003eSmali 분석 특징\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003edex → smali 변조 가능\u003c/li\u003e\n\u003cli\u003eJava 코드 직접 변조는 불가\u003c/li\u003e\n\u003cli\u003esmali 수정 후 재빌드 필요\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003eAPK 변조 흐름\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eAPK 디컴파일\u003c/li\u003e\n\u003cli\u003eJava 코드 기준으로 로직 분석\u003c/li\u003e\n\u003cli\u003e대응되는 \u003ccode\u003e.smali\u003c/code\u003e 코드 탐색\u003c/li\u003e\n\u003cli\u003esmali 코드 직접 수정\u003c/li\u003e\n\u003cli\u003e재빌드 및 재서명\u003c/li\u003e\n\u003cli\u003e설치 후 실행\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3\u003eActivity 실행\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eam start 액티비티이름\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003eCPU ABI 확인\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eBuild.CPU_ABI\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e예: \u003ccode\u003earm64-v8a\u003c/code\u003e, \u003ccode\u003ex86_64\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003eSmali 조건 분기 정리\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eif-eq v0, v1      같으면 분기\r\nif-neq v0, v1     다르면 분기\r\nif-eqz v0         v0 == 0\r\nif-nez v0         v0 != 0\r\nif-lt v0, v1      v0 \u0026#x3C; v1\r\nif-le v0, v1      v0 \u0026#x3C;= v1\r\nif-gt v0, v1      v0 \u003e v1\r\nif-ge v0, v1      v0 \u003e= v1\r\nif-ltz v0         v0 \u0026#x3C; 0\r\nif-lez v0         v0 \u0026#x3C;= 0\r\nif-gtz v0         v0 \u003e 0\r\nif-gez v0         v0 \u003e= 0\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003eCRC 무결성 확인\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e원본 APK \u003ccode\u003eclasses.dex\u003c/code\u003e CRC\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e1302005358\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e변조된 APK \u003ccode\u003eclasses.dex\u003c/code\u003e CRC\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e2993910671\n\u003c/code\u003e\u003c/pre\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"className\":\"article-container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article-header\",\"children\":[[\"$\",\"span\",null,{\"className\":\"article-category\",\"children\":\"Android\"}],[\"$\",\"h1\",null,{\"className\":\"article-title\",\"children\":\"Android 보안 8일차\"}]]}],[\"$\",\"div\",null,{\"className\":\"article-content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$f\"}}]]}]\nc:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title"])</script><script>self.__next_f.push([1,"\",\"2\",{\"children\":\"jinwk note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"jinwk dev note\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>