---
layout: default
title: "Android λ³΄μ• 8μΌμ°¨"
parent: Android
nav_order: 8
---

#  μ•λ“λ΅μ΄λ“ μ•± μ •μ  λ¶„μ„ λ° λ³€μ΅° λ¶„μ„ λ¦¬ν¬νΈ

## 1. μ •μ  λ¶„μ„ 4λ²: AES-CBC μ•”νΈν™” λ¶„μ„

S3 λ“± κ³µμ  μ„¤μ • νμΌ(`app_prefs.xml`)μ— μ €μ¥λ λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•λ” κ³Όμ •μ…λ‹λ‹¤.

### π“‹ μ•”νΈν™” λ…μ„Έ

- **μ•κ³ λ¦¬μ¦**: `AES / CBC / PKCS5Padding`
- **λΉ„λ°€ν‚¤ (Key)**: `0123456789abcdef` (λ°”μ΄νΈ λ°°μ—΄ `bArr`)
- **μ΄κΈ°ν™” λ²΅ν„° (IV)**: λλ¤ 16λ°”μ΄νΈ (`bArr2`)
- **λ°μ΄ν„° κµ¬μ΅°**: `Base64(IV(16λ°”μ΄νΈ) + μ•”νΈλ¬Έ)`

### π” λ³µνΈν™” μ‹¤μµ

1. **λ€μƒ κ°’**: `iDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY`
2. **Base64 λ””μ½”λ”© κ²°κ³Ό (Hex)**:
   - `88 38 a0 5e 88 40 e2 79 75 61 75 91 74 da 34 2d` (μ• 16λ°”μ΄νΈ β†’ **IV**)
   - `a7 9c 57 fe d7 01 f7 84 8d 18 df ca 06 bc 3b 33 12 ee bc 47 06 6b 26 e7 0c ff 1e 34 d0 92 a8 98` (λ‚λ¨Έμ§€ β†’ **μ•”νΈλ¬Έ**)
3. **κ²°κ³Ό**: μ„ ν‚¤μ™€ IVλ¥Ό μ‚¬μ©ν•μ—¬ AES-CBC λ³µνΈν™” μ‹ μ›λ¬Έ ν”λκ·Έ νλ“ κ°€λ¥.

------

## 2. μ •μ  λ¶„μ„ 5λ²: AES-GCM (PBKDF2) λ¶„μ„

κ³ λ„ν™”λ ν‚¤ μ λ„ ν•¨μμ™€ μΈμ¦ μ•”νΈν™” λ°©μ‹μ΄ μ μ©λ μΌ€μ΄μ¤μ…λ‹λ‹¤.

### π“‹ μ•”νΈν™” λ…μ„Έ

- **μ•κ³ λ¦¬μ¦**: `AES / GCM / NoPadding`
- **ν‚¤ μ λ„ (KDF)**: `PBKDF2WithHmacSHA256` (λλ” SHA1)
  - **Password**: `"eqst_lms"`
  - **Salt**: λλ¤ 16λ°”μ΄νΈ (`bArr`)
  - **Iteration**: `150,000`
  - **Key Length**: `256 bits`
- **GCM μ„¤μ •**: IV 12λ°”μ΄νΈ (`bArr2`), Tag 128λΉ„νΈ (16λ°”μ΄νΈ)
- **λ°μ΄ν„° κµ¬μ΅°**: `Base64( 0x01(1) + Salt(16) + IV(12) + Ciphertext(n) + GCM_Tag(16) )`

### π” λ³µνΈν™” λ¶„μ„

1. **λ€μƒ κ°’**: `AZ/oUGgQWbCw9isMhikWIkSrSfGQuG+YU82+0jgKjb0bGfwtRWmne9Wku1y7Tyg/c99gKAYGPuIAvTVfdg==`
2. **κµ¬μ΅° λ¶„ν•΄**:
   - **Version**: `01`
   - **Salt**: `9f e8 50 68 10 59 b0 b0 f6 2b 0c 86 29 16 22 44`
   - **Derived Key**: μ„ Saltμ™€ ν¨μ¤μ›λ“λ΅ μ λ„λ 256λΉ„νΈ ν‚¤
   - **IV**: `ab 49 f1 90 b8 6f 98 53 cd be d2 38`
   - **Ciphertext**: `0a 8d bd 1b 19 fc 2d 45 69 a7 7b d5 a4 bb 5c bb`
   - **GCM Tag**: `4f 28 3f 73 df 60 28 06 06 3e e2 00 bd 35 5f 76`

------

## 3. μ•± λ³€μ΅° λ° Smali λ¶„μ„ μ „λµ

Java μ½”λ“λ¥Ό μ§μ ‘ μμ •ν•  μ μ—†μ„ λ•, λ””μ»΄νμΌλ Smali μ½”λ“λ¥Ό μμ •ν•μ—¬ λ΅μ§μ„ μ°νν•©λ‹λ‹¤.

### π› οΈ κ³µκ²© μ›ν¬ν”λ΅μ°

1. **λ””μ»΄νμΌ**: `apktool` λ“±μ„ μ΄μ©ν•΄ APKλ¥Ό Smali μ½”λ“λ΅ μ¶”μ¶.
2. **μ½”λ“ λ¶„μ„**: Java μ†μ¤μ™€ λ§¤μΉ­λλ” Smali μ„μΉ μ‹λ³„.
3. **μ½”λ“ λ³€μ΅°**: λ¶„κΈ°λ¬Έ(`if-eq` λ“±)μ„ λ°λ€λ΅ μμ •ν•κ±°λ‚ κ°•μ  μ΄λ™ μ„¤μ •.
4. **λ¦¬λΉλ“ & μ„λ…**: `apktool build` ν›„ `apksigner`λ΅ μ„λ….
5. **μ‹¤ν–‰**: `am start -n [ν¨ν‚¤μ§€λ…]/[μ•΅ν‹°λΉ„ν‹°]` λ…λ ΉμΌλ΅ μ‹¤ν–‰ ν™•μΈ.

### π“‘ Smali μ£Όμ” μ΅°κ±΄ λ¶„κΈ°λ¬Έ μ •λ¦¬

| **Smali λ…λ Ήμ–΄**       | **μλ―Έ**           | **λΉ„κ³ **         |
| ---------------------- | ------------------ | ---------------- |
| `if-eq v0, v1, :cond`  | v0 == v1 μ΄λ©΄ μ΄λ™ | Equal            |
| `if-neq v0, v1, :cond` | v0 != v1 μ΄λ©΄ μ΄λ™ | Not Equal        |
| `if-eqz v0, :cond`     | v0 == 0 μ΄λ©΄ μ΄λ™  | Equal Zero       |
| `if-nez v0, :cond`     | v0 != 0 μ΄λ©΄ μ΄λ™  | Not Zero         |
| `if-lt v0, v1, :cond`  | v0 < v1 μ΄λ©΄ μ΄λ™  | Less Than        |
| `if-le v0, v1, :cond`  | v0 <= v1 μ΄λ©΄ μ΄λ™ | Less or Equal    |
| `if-gt v0, v1, :cond`  | v0 > v1 μ΄λ©΄ μ΄λ™  | Greater Than     |
| `if-ge v0, v1, :cond`  | v0 >= v1 μ΄λ©΄ μ΄λ™ | Greater or Equal |

------

## 4. λ¬΄κ²°μ„± κ²€μ¦ μ°ν (Integrity Check)

μ•±μ΄ μμ‹ μ `classes.dex` νμΌμ ν•΄μ‹(CRC) κ°’μ„ κ²€μ‚¬ν•λ” λ΅μ§μ΄ μμ„ κ²½μ°, λ³€μ΅° ν›„ μ΄ κ°’μ„ λ§μ¶°μ£Όμ–΄μ•Ό ν•©λ‹λ‹¤.

- **μ›λ³Έ CRC**: `1302005358`
- **λ³€μ΅° ν›„ CRC**: `2993910671`
- **μ°ν λ°©λ²•**: Smali μ½”λ“ λ‚΄μ—μ„ ν•λ“μ½”λ”©λ μ›λ³Έ CRC λΉ„κµλ¬Έμ„ μ°Ύμ•„ λ³€μ΅°λ κ°’μΌλ΅ μμ •ν•κ±°λ‚, λΉ„κµ κ²°κ³Όκ°€ ν•­μƒ μ°Έμ΄ λλ„λ΅ μμ •ν•©λ‹λ‹¤.

------

**π’΅ λ¶„μ„ ν**: `showflag("\u007f|ezbk}xv-", "infosec")`μ™€ κ°™μ€ ν•¨μλ” λ¬Έμμ—΄ XOR μ—°μ‚°μ΄λ‚ κ°„λ‹¨ν• μΉν™ μ•κ³ λ¦¬μ¦μΌ κ°€λ¥μ„±μ΄ λ†’μΌλ―€λ΅, ν•΄λ‹Ή ν•¨μμ λ‚΄λ¶€ λ΅μ§μ„ Smaliμ—μ„ μ¶”μ ν•λ©΄ ν”λκ·Έλ¥Ό λ°”λ΅ μ–»μ„ μ μμµλ‹λ‹¤.