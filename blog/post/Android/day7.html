<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/profile_cute.png"/><link rel="stylesheet" href="/blog/_next/static/css/fff7d7d50ba66cff.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/blog/_next/static/chunks/webpack-b722ef4425a8164b.js" crossorigin=""/><script src="/blog/_next/static/chunks/fd9d1056-c50cb70e7323352b.js" async="" crossorigin=""></script><script src="/blog/_next/static/chunks/69-d16584ac8b52728e.js" async="" crossorigin=""></script><script src="/blog/_next/static/chunks/main-app-baff347ce7e39457.js" async="" crossorigin=""></script><script src="/blog/_next/static/chunks/250-63ba7a57e29c9f6e.js" async=""></script><script src="/blog/_next/static/chunks/app/layout-ada0ccfdc2732042.js" async=""></script><title>jinwk note</title><meta name="description" content="jinwk dev note"/><script>
              (function() {
                try {
                  const savedTheme = localStorage.getItem('theme');
                  // Default to 'dark' if no save found, ignoring system preference for now to start dark
                  const theme = savedTheme || 'dark';
                  document.documentElement.setAttribute('data-theme', theme);
                } catch (e) {}
              })();
            </script><script src="/blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><div class="app-container"><aside class="sidebar"><div class="profile-section"><div class="profile-img-wrapper"><img src="/profile_cute.png" alt="Profile" class="profile-img"/></div><div class="profile-name" style="display:flex;align-items:center;justify-content:center;gap:0.5rem">jinwook yu<a style="font-size:0.9rem;opacity:0.5;text-decoration:none" href="/blog/admin">⚙️</a></div><div class="profile-subtitle" style="font-size:0.9rem;color:var(--text-muted);margin-bottom:1rem">dbwlsdnr95</div><div class="profile-bio" style="white-space:pre-line;font-size:0.85rem;text-align:left;width:100%">웹·모바일 진단 ,솔루션 운영 및 클라우드 보안을 경험했고, 현재는 모의해킹·취약점 분석·CVE 연구에 집중하고 있습니다. 실전 기반 보안 역량을 꾸준히 확장하고 있습니다.</div></div><nav class="nav-section"><div class="nav-title">분류 전체보기</div><ul class="nav-list" style="margin-bottom:2rem"><li class="nav-item"><a class="" href="/blog">전체보기</a></li></ul><div style="margin-bottom:2rem"><div class="nav-title">교육</div><ul class="nav-list"><li class="nav-item"><a class="" href="/blog/category/Android">Android</a></li><li class="nav-item"><a class="" href="/blog/category/JAVA">JAVA</a></li><li class="nav-item"><a class="" href="/blog/category/AWS">AWS</a></li></ul></div></nav></aside><main class="main-content"><article class="article-container"><div class="article-header"><span class="article-category">Android</span><h1 class="article-title">Android 보안 7일차</h1></div><div class="article-content"><h1>Android Security – (정적 분석)</h1>
<blockquote>
<p><strong>정적 분석(Static Analysis)</strong>
앱을 실행하지 않은 상태에서 <strong>APK를 디컴파일</strong>하여 내부 로직, 암호화 방식, 검증 로직 등을 분석하는 기법</p>
</blockquote>
<hr>
<h2>1. 정적 분석 개요</h2>
<ul>
<li>앱 <strong>미실행 상태</strong></li>
<li>APK → 디컴파일 → 코드 분석</li>
<li>주요 분석 대상
<ul>
<li>Java / Kotlin 코드</li>
<li>Smali 코드</li>
<li>AndroidManifest.xml</li>
<li>암호화 로직</li>
<li>하드코딩된 키 / 힌트</li>
</ul>
</li>
</ul>
<hr>
<h2>2. Smali 코드 분석</h2>
<h3>2.1 Smali란?</h3>
<ul>
<li>Dalvik VM용 어셈블리 코드</li>
<li><strong>ASM(어셈블리)와 유사</strong></li>
<li><code>classes.dex</code> → smali 변환</li>
</ul>
<pre><code>add v0, v1
sub v2, v3
jmp :label
</code></pre>
<hr>
<h3>2.2 Null 체크 코드</h3>
<pre><code>Intrinsics.checkNotNullParameter(obj, "param");
</code></pre>
<ul>
<li>Kotlin에서 자동 생성</li>
<li><strong>의미</strong>
<ul>
<li>검증 로직이 많다는 뜻</li>
<li>단순 NPE 방지용</li>
</ul>
</li>
<li>디버깅 시 <strong>노이즈가 많아짐</strong></li>
<li>보안 검증과 직접적인 연관은 적음</li>
</ul>
<hr>
<h2>3. Java 코드 정적 분석 흐름</h2>
<h3>3.1 기본 분석 순서</h3>
<pre><code>AndroidManifest.xml
 → Activity 선언
   → onCreate()
     → onClick()
       → 특정 메소드 / 로직
</code></pre>
<hr>
<h3>3.2 함수 호출 관계 추적</h3>
<pre><code>function(arg1, arg2, arg3)
</code></pre>
<ul>
<li>분석 포인트
<ul>
<li>이 함수는 <strong>어디서 호출되는가</strong></li>
<li>외부 입력값이 전달되는가</li>
<li>Intent / Extra 포함 여부</li>
</ul>
</li>
</ul>
<hr>
<h3>3.3 클래스 구조</h3>
<pre><code>Intent intent = new Intent(this, MainActivity.class);
Class → Instance
new Class()
</code></pre>
<ul>
<li>Activity는 <strong>클래스 기반 객체</strong></li>
<li>외부 Intent 조작 가능성 확인</li>
</ul>
<hr>
<h2>4. 정적 분석 실습 1 – ASCII 배열 복원</h2>
<ul>
<li>ASCII 값 배열 → 문자열 변환</li>
<li>암호화 힌트 은닉용으로 자주 사용</li>
</ul>
<pre><code>[65, 66, 67] → "ABC"
</code></pre>
<hr>
<h2>5. 정적 분석 실습 2 – XOR 기반 암호화 분석</h2>
<h3>5.1 코드 핵심</h3>
<pre><code>UIStyles.INSTANCE.showMessageDialog(
  mainActivity,
  "HINT",
  "appPkg: aos\nTEST_HEX: " +
  encrypter.bytesToHex(
    encrypter2.encrypt(bytes, bArrDeriveKey4)
  )
);
</code></pre>
<hr>
<h3>5.2 키 생성 로직 분석</h3>
<pre><code>String str = appPkg + ":" + hint;
// "aos:CUSTOM_XOR_V1"
byte[] bytes = str.getBytes(UTF_8);
int iCrc32 = crc32(bytes);
</code></pre>
<ul>
<li>CRC32 체크섬 계산</li>
<li>결과값에서 <strong>4바이트만 키로 사용</strong></li>
</ul>
<pre><code>return new byte[]{
  (byte)((iCrc32 >>> 24) &#x26; 255),
  (byte)((iCrc32 >>> 16) &#x26; 255),
  (byte)((iCrc32 >>> 8) &#x26; 255),
  (byte)(iCrc32 &#x26; 255)
};
</code></pre>
<h3>5.3 최종 키</h3>
<pre><code>KEY = [f6, 70, 77, 23]
</code></pre>
<hr>
<h3>5.4 XOR 암호화 원리</h3>
<h4>논리 연산 정리</h4>
<p>| 연산    | 설명               |
| ------- | ------------------ |
| AND (&#x26;) | 둘 다 참일 때만 참 |
| OR (    | )                  |
| XOR (^) | 서로 다를 때만 참  |</p>
<pre><code>X ^ X = 0
X ^ 0 = X
(X ^ K) ^ K = X
</code></pre>
<hr>
<h3>5.5 암호화 로직</h3>
<pre><code>for (int i = 0; i &#x3C; length; i++) {
  bArr[i] =
    (byte)(
      (
        (key4[i &#x26; 3] + (i * 11)) &#x26; 255
      ) ^ plain[i]
    );
}
</code></pre>
<ul>
<li>키는 4바이트 반복 사용</li>
<li><code>i * 11</code> 값이 가변성 추가</li>
<li><strong>XOR → 복호화도 동일 로직</strong></li>
</ul>
<hr>
<h2>6. 정적 분석 실습 3 – AES 고정 키/IV</h2>
<h3>6.1 코드</h3>
<pre><code>byte[] key = "0123456789abcdef".getBytes();
byte[] iv  = "fedcba0123456789".getBytes();

cipher.init(
  Cipher.ENCRYPT_MODE,
  new SecretKeySpec(key, "AES"),
  new IvParameterSpec(iv)
);
</code></pre>
<ul>
<li>알고리즘: <strong>AES/CBC/PKCS5Padding</strong></li>
<li>키 &#x26; IV 하드코딩</li>
</ul>
<hr>
<h3>6.2 복호화 절차</h3>
<ol>
<li>Base64 디코딩</li>
<li>AES 복호화</li>
<li>결과 평문 획득</li>
</ol>
<pre><code>암호문: tq3mPVo8iY+xHYFinxgt/A==
평문: decrypt_easy
</code></pre>
<hr>
<h2>7. 정적 분석 실습 4 – IV 포함 암호문 구조</h2>
<h3>7.1 암호문 구조</h3>
<pre><code>[ IV (16 bytes) ][ 암호화 데이터 ]
iDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY
</code></pre>
<hr>
<h3>7.2 복호화 절차</h3>
<ol>
<li>Base64 디코딩</li>
<li>앞 16바이트 → IV</li>
<li>나머지 → CipherText</li>
<li>AES/CBC/PKCS5Padding 복호화</li>
</ol>
<pre><code>Key: 0123456789abcdef
IV : 암호문 앞 16바이트
</code></pre>
<hr>
<h2>8. 정적 분석 핵심 체크리스트</h2>
<p>AndroidManifest 내 Exported Activity
Intent Extra 권한 검증 여부
하드코딩 키 / IV
XOR / CRC32 기반 커스텀 암호화
복호화 가능 여부
힌트 문자열 UI 노출 여부</p>
<hr>
<h2>9. 핵심 요약</h2>
<ul>
<li>정적 분석은 <strong>로직을 이해하는 싸움</strong></li>
<li>암호화라도 <strong>키가 노출되면 무의미</strong></li>
<li>XOR 기반 암호화는 대부분 <strong>즉시 복호화 가능</strong></li>
<li>AES라도 <strong>키/IV 하드코딩은 치명적</strong></li>
</ul>
</div></article></main></div><script src="/blog/_next/static/chunks/webpack-b722ef4425a8164b.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/blog/_next/static/css/fff7d7d50ba66cff.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7690,[],\"\"]\n6:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[8383,[\"250\",\"static/chunks/250-63ba7a57e29c9f6e.js\",\"185\",\"static/chunks/app/layout-ada0ccfdc2732042.js\"],\"\"]\nc:I[8955,[],\"\"]\n7:[\"category\",\"Android\",\"d\"]\n8:[\"slug\",\"day7\",\"d\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/blog/_next/static/css/fff7d7d50ba66cff.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"UQ-na9S7VveNwpUsd699O\",\"assetPrefix\":\"/blog\",\"initialCanonicalUrl\":\"/post/Android/day7\",\"initialTree\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day7\",\"d\"],{\"children\":[\"__PAGE__?{\\\"category\\\":\\\"Android\\\",\\\"slug\\\":\\\"day7\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"post\",{\"children\":[[\"category\",\"Android\",\"d\"],{\"children\":[[\"slug\",\"day7\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L4\",\"$L5\",null]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\",\"$7\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"post\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\\n              (function() {\\n                try {\\n                  const savedTheme = localStorage.getItem('theme');\\n                  // Default to 'dark' if no save found, ignoring system preference for now to start dark\\n                  const theme = savedTheme || 'dark';\\n                  document.documentElement.setAttribute('data-theme', theme);\\n                } catch (e) {}\\n              })();\\n            \"}}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"app-container\",\"children\":[[\"$\",\"$La\",null,{\"categories\":[\"AWS\",\"Android\",\"JAVA\"]}],[\"$\",\"main\",null,{\"className\":\"main-content\",\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}]]}]}]]}],null]],\"initialHead\":[false,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]]\n"])</script><script>self.__next_f.push([1,"e:T15d6,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eAndroid Security – (정적 분석)\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e정적 분석(Static Analysis)\u003c/strong\u003e\r\n앱을 실행하지 않은 상태에서 \u003cstrong\u003eAPK를 디컴파일\u003c/strong\u003e하여 내부 로직, 암호화 방식, 검증 로직 등을 분석하는 기법\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003chr\u003e\n\u003ch2\u003e1. 정적 분석 개요\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e앱 \u003cstrong\u003e미실행 상태\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eAPK → 디컴파일 → 코드 분석\u003c/li\u003e\n\u003cli\u003e주요 분석 대상\n\u003cul\u003e\n\u003cli\u003eJava / Kotlin 코드\u003c/li\u003e\n\u003cli\u003eSmali 코드\u003c/li\u003e\n\u003cli\u003eAndroidManifest.xml\u003c/li\u003e\n\u003cli\u003e암호화 로직\u003c/li\u003e\n\u003cli\u003e하드코딩된 키 / 힌트\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e2. Smali 코드 분석\u003c/h2\u003e\n\u003ch3\u003e2.1 Smali란?\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDalvik VM용 어셈블리 코드\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eASM(어셈블리)와 유사\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eclasses.dex\u003c/code\u003e → smali 변환\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003eadd v0, v1\r\nsub v2, v3\r\njmp :label\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e2.2 Null 체크 코드\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eIntrinsics.checkNotNullParameter(obj, \"param\");\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eKotlin에서 자동 생성\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e의미\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e검증 로직이 많다는 뜻\u003c/li\u003e\n\u003cli\u003e단순 NPE 방지용\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e디버깅 시 \u003cstrong\u003e노이즈가 많아짐\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e보안 검증과 직접적인 연관은 적음\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e3. Java 코드 정적 분석 흐름\u003c/h2\u003e\n\u003ch3\u003e3.1 기본 분석 순서\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eAndroidManifest.xml\r\n → Activity 선언\r\n   → onCreate()\r\n     → onClick()\r\n       → 특정 메소드 / 로직\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e3.2 함수 호출 관계 추적\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003efunction(arg1, arg2, arg3)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e분석 포인트\n\u003cul\u003e\n\u003cli\u003e이 함수는 \u003cstrong\u003e어디서 호출되는가\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e외부 입력값이 전달되는가\u003c/li\u003e\n\u003cli\u003eIntent / Extra 포함 여부\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e3.3 클래스 구조\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eIntent intent = new Intent(this, MainActivity.class);\r\nClass → Instance\r\nnew Class()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eActivity는 \u003cstrong\u003e클래스 기반 객체\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e외부 Intent 조작 가능성 확인\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e4. 정적 분석 실습 1 – ASCII 배열 복원\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eASCII 값 배열 → 문자열 변환\u003c/li\u003e\n\u003cli\u003e암호화 힌트 은닉용으로 자주 사용\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003e[65, 66, 67] → \"ABC\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e5. 정적 분석 실습 2 – XOR 기반 암호화 분석\u003c/h2\u003e\n\u003ch3\u003e5.1 코드 핵심\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eUIStyles.INSTANCE.showMessageDialog(\r\n  mainActivity,\r\n  \"HINT\",\r\n  \"appPkg: aos\\nTEST_HEX: \" +\r\n  encrypter.bytesToHex(\r\n    encrypter2.encrypt(bytes, bArrDeriveKey4)\r\n  )\r\n);\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e5.2 키 생성 로직 분석\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eString str = appPkg + \":\" + hint;\r\n// \"aos:CUSTOM_XOR_V1\"\r\nbyte[] bytes = str.getBytes(UTF_8);\r\nint iCrc32 = crc32(bytes);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003eCRC32 체크섬 계산\u003c/li\u003e\n\u003cli\u003e결과값에서 \u003cstrong\u003e4바이트만 키로 사용\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode\u003ereturn new byte[]{\r\n  (byte)((iCrc32 \u003e\u003e\u003e 24) \u0026#x26; 255),\r\n  (byte)((iCrc32 \u003e\u003e\u003e 16) \u0026#x26; 255),\r\n  (byte)((iCrc32 \u003e\u003e\u003e 8) \u0026#x26; 255),\r\n  (byte)(iCrc32 \u0026#x26; 255)\r\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e5.3 최종 키\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eKEY = [f6, 70, 77, 23]\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e5.4 XOR 암호화 원리\u003c/h3\u003e\n\u003ch4\u003e논리 연산 정리\u003c/h4\u003e\n\u003cp\u003e| 연산    | 설명               |\r\n| ------- | ------------------ |\r\n| AND (\u0026#x26;) | 둘 다 참일 때만 참 |\r\n| OR (    | )                  |\r\n| XOR (^) | 서로 다를 때만 참  |\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eX ^ X = 0\r\nX ^ 0 = X\r\n(X ^ K) ^ K = X\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e5.5 암호화 로직\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003efor (int i = 0; i \u0026#x3C; length; i++) {\r\n  bArr[i] =\r\n    (byte)(\r\n      (\r\n        (key4[i \u0026#x26; 3] + (i * 11)) \u0026#x26; 255\r\n      ) ^ plain[i]\r\n    );\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e키는 4바이트 반복 사용\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ei * 11\u003c/code\u003e 값이 가변성 추가\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eXOR → 복호화도 동일 로직\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003e6. 정적 분석 실습 3 – AES 고정 키/IV\u003c/h2\u003e\n\u003ch3\u003e6.1 코드\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003ebyte[] key = \"0123456789abcdef\".getBytes();\r\nbyte[] iv  = \"fedcba0123456789\".getBytes();\r\n\r\ncipher.init(\r\n  Cipher.ENCRYPT_MODE,\r\n  new SecretKeySpec(key, \"AES\"),\r\n  new IvParameterSpec(iv)\r\n);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e알고리즘: \u003cstrong\u003eAES/CBC/PKCS5Padding\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e키 \u0026#x26; IV 하드코딩\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3\u003e6.2 복호화 절차\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eBase64 디코딩\u003c/li\u003e\n\u003cli\u003eAES 복호화\u003c/li\u003e\n\u003cli\u003e결과 평문 획득\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e암호문: tq3mPVo8iY+xHYFinxgt/A==\r\n평문: decrypt_easy\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e7. 정적 분석 실습 4 – IV 포함 암호문 구조\u003c/h2\u003e\n\u003ch3\u003e7.1 암호문 구조\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e[ IV (16 bytes) ][ 암호화 데이터 ]\r\niDigXohA4nl1YXWRdNo0LaecV/7XAfeEjRjfyga8OzMS7rxHBmsm5wz/HjTQkqiY\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch3\u003e7.2 복호화 절차\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eBase64 디코딩\u003c/li\u003e\n\u003cli\u003e앞 16바이트 → IV\u003c/li\u003e\n\u003cli\u003e나머지 → CipherText\u003c/li\u003e\n\u003cli\u003eAES/CBC/PKCS5Padding 복호화\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003eKey: 0123456789abcdef\r\nIV : 암호문 앞 16바이트\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2\u003e8. 정적 분석 핵심 체크리스트\u003c/h2\u003e\n\u003cp\u003eAndroidManifest 내 Exported Activity\r\nIntent Extra 권한 검증 여부\r\n하드코딩 키 / IV\r\nXOR / CRC32 기반 커스텀 암호화\r\n복호화 가능 여부\r\n힌트 문자열 UI 노출 여부\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003e9. 핵심 요약\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e정적 분석은 \u003cstrong\u003e로직을 이해하는 싸움\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e암호화라도 \u003cstrong\u003e키가 노출되면 무의미\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eXOR 기반 암호화는 대부분 \u003cstrong\u003e즉시 복호화 가능\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eAES라도 \u003cstrong\u003e키/IV 하드코딩은 치명적\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"className\":\"article-container\",\"children\":[[\"$\",\"div\",null,{\"className\":\"article-header\",\"children\":[[\"$\",\"span\",null,{\"className\":\"article-category\",\"children\":\"Android\"}],[\"$\",\"h1\",null,{\"className\":\"article-title\",\"children\":\"Android 보안 7일차\"}]]}],[\"$\",\"div\",null,{\"className\":\"article-content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$e\"}}]]}]\nb:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title"])</script><script>self.__next_f.push([1,"\",\"2\",{\"children\":\"jinwk note\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"jinwk dev note\"}]]\n4:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>